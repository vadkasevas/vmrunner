"use strict";var _interopRequireDefault3 = require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireDefault2 = _interopRequireDefault3(require("@babel/runtime/helpers/interopRequireDefault"));Object.defineProperty(exports, "__esModule", { value: true });var _typeof2 = require("@babel/runtime/helpers/typeof");var _typeof = (0, _interopRequireDefault2["default"])(_typeof2)["default"];exports.





































getLogFunction = getLogFunction;exports.











































































































































handleLabeledStatement = handleLabeledStatement;exports["default"] =























































































































































































































function (babel) {
  return {
    visitor: {
      Program: function Program(program, _ref3) {var opts = _ref3.opts;
        program.traverse({
          LabeledStatement: function LabeledStatement(path) {
            handleLabeledStatement(babel, path, opts);
          } });


        if (!program.vmRunnerWrapper) {
          program.vmRunnerWrapper = true;
          var wrapped = wrapVmRunner({
            BODY: program.node.body,
            VM_RUNNER_RUN_ID: babel.types.identifier('VM_RUNNER_RUN_ID'),
            VM_RUNNER_HASH: babel.types.identifier('VM_RUNNER_HASH'),
            VM_RUNNER_TRACE: babel.types.identifier('VM_RUNNER_TRACE') });


          program.replaceWith(
          babel.types.program(wrapped));

        }
        program.node.directives = [];

      } } };


};var _path = require("path");var fspath = (0, _interopRequireDefault2["default"])(_path)["default"];var _underscore = require("underscore");var _ = (0, _interopRequireDefault2["default"])(_underscore)["default"];var _template = require("@babel/template");var template = (0, _interopRequireDefault2["default"])(_template)["default"];var _lodash = require("lodash");var get = _lodash.get;var $handled = Symbol('handled');var $normalized = Symbol('normalized');var PRESERVE_CONTEXTS = normalizeEnv(process.env.TRACE_CONTEXT);var PRESERVE_FILES = normalizeEnv(process.env.TRACE_FILE);var PRESERVE_LEVELS = normalizeEnv(process.env.TRACE_LEVEL); /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Normalize an environment variable, used to override plugin options.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   */function normalizeEnv(input) {if (!input) {return [];}return input.split(',').map(function (context) {return context.toLowerCase().trim();}).filter(function (id) {return id;});} /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Like `template()` but returns an expression, not an expression statement.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        */function expression(input, template) {var fn = template(input);return function (ids) {var node = fn(ids);return node.expression ? node.expression : node;};} /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * The default log() function.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        */function getLogFunction(_ref, logLevel) {var t = _ref.types,template = _ref.template;return function log(message, metadata) {var messageExpression = message.messageExpression;var prefix = "".concat(metadata.context, ":");if (metadata.indent) {prefix += new Array(metadata.indent + 1).join('  ');}if (t.isSequenceExpression(message.content)) {return t.callExpression(t.memberExpression(t.identifier('console'), t.identifier(logLevel)), [t.stringLiteral(prefix)].concat(message.content.expressions));} else {var LINE = metadata.path.node.loc.start.line;return expression("VM_RUNNER_TRACE.apply({line:LINE},[LOGLEVEL, PREFIX, MESSAGE,  DATA])", template)({ LOGLEVEL: t.stringLiteral(logLevel), PREFIX: t.stringLiteral(prefix), DATA: message.content, LINE: t.numericLiteral(LINE), VM_RUNNER_TRACE: t.identifier('VM_RUNNER_TRACE'), MESSAGE: messageExpression });}};}function generatePrefix(dirname, basename) {if (basename !== 'index') {return basename;}basename = fspath.basename(dirname);if (basename !== 'src' && basename !== 'lib') {return basename;}return fspath.basename(fspath.dirname(dirname));} /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Collect the metadata for a given node path, which will be
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * made available to logging functions.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */function collectMetadata(path, opts) {var filename = fspath.resolve(process.cwd(), path.hub.file.opts.filename);var dirname = fspath.dirname(filename);var extname = fspath.extname(filename);var basename = fspath.basename(filename, extname);var prefix = generatePrefix(dirname, basename);var names = [];var indent = 0;var parent;var parentName = path.getAncestry().slice(1).reduce(function (parts, item) {if (item.isClassMethod()) {if (!parent) {parent = item;}parts.unshift(item.node.key.type === 'Identifier' ? item.node.key.name : '[computed method]');} else if (item.isClassDeclaration()) {if (!parent) {parent = item;}parts.unshift(item.node.id ? item.node.id.name : "[anonymous class@".concat(item.node.loc.start.line, "]"));} else if (item.isFunction()) {if (!parent) {parent = item;}parts.unshift(item.node.id && item.node.id.name || "[anonymous@".concat(item.node.loc.start.line, "]"));} else if (item.isProgram()) {if (!parent) {parent = item;}} else if (!parent && !item.isClassBody() && !item.isBlockStatement()) {indent++;}return parts;}, []).join(':');var hasStartMessage = false;var isStartMessage = false;if (parent && !parent.isProgram()) {var _iteratorNormalCompletion = true;var _didIteratorError = false;var _iteratorError = undefined;try {for (var _iterator = parent.get('body').get('body')[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {var child = _step.value;if (child.node[$handled]) {hasStartMessage = true;break;}if (!child.isLabeledStatement()) {break;}var label = child.get('label');if (opts.aliases[label.node.name]) {hasStartMessage = true;if (child.node === path.node) {isStartMessage = true;}break;}}} catch (err) {_didIteratorError = true;_iteratorError = err;} finally {try {if (!_iteratorNormalCompletion && _iterator["return"] != null) {_iterator["return"]();}} finally {if (_didIteratorError) {throw _iteratorError;}}}}var context = "".concat(prefix, ":").concat(parentName);return { indent: indent, prefix: prefix, parentName: parentName, context: context, hasStartMessage: hasStartMessage, isStartMessage: isStartMessage, filename: filename, dirname: dirname, basename: basename, extname: extname, path: path };} /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Determine whether the given logging statement should be stripped.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */function shouldStrip(name, metadata, _ref2) {var strip = _ref2.strip;switch (_typeof(strip)) {case 'boolean':if (!strip) return false; // strip === true
      break;case 'object':var se = strip[name];if (!se || _typeof(se) === 'object' && !se[process.env.NODE_ENV]) return false; // strip[name] === true || strip[name][env] === true
      break;default:return false;}if (PRESERVE_CONTEXTS.length) {var context = metadata.context.toLowerCase();if (PRESERVE_CONTEXTS.some(function (pc) {return context.includes(pc);})) return false;}if (PRESERVE_FILES.length) {var filename = metadata.filename.toLowerCase();if (PRESERVE_FILES.some(function (pf) {return filename.includes(pf);})) return false;}if (PRESERVE_LEVELS.length) {var level = name.toLowerCase();if (PRESERVE_LEVELS.some(function (pl) {return level === pl;})) return false;}return true;}function handleLabeledStatement(babel, path, opts) {var t = babel.types;var label = path.get('label');opts = function normalizeOpts(babel, opts) {if (opts[$normalized]) {return opts;}if (!opts.aliases) {opts.aliases = { log: getLogFunction(babel, 'log'), trace: getLogFunction(babel, 'trace'), warn: getLogFunction(babel, 'warn') };} else {Object.keys(opts.aliases).forEach(function (key) {if (typeof opts.aliases[key] === 'string' && opts.aliases[key]) {var expr = expression(opts.aliases[key], babel.template);opts.aliases[key] = function (message) {return expr(message);};}});}if (opts.strip === undefined) {opts.strip = { log: { production: true }, trace: false, warn: { production: true } };}opts[$normalized] = true;return opts;}(babel, opts);var labelName = label.node.name;var variables = [];var methodPath = get(path, 'parentPath.parentPath', null);if (methodPath && ['ClassMethod', 'ObjectMethod'].indexOf(methodPath.type) > -1 && !methodPath.node["static"]) {variables.push('this');}_.each(path.scope.bindings, function (val, key) {if (variables.indexOf(key) == -1) variables.push(key);});var alias = opts.aliases[labelName];if (!alias) {return;}var metadata = collectMetadata(path, opts);if (shouldStrip(label.node.name, metadata, opts)) {path.remove();return;}path.traverse({ "EmptyStatement": function EmptyStatement(emptyStatement) {var properties = _.map(variables, function (varName) {var key = t.Identifier(varName);var value;if (varName != 'this') {value = t.Identifier(varName);} else {value = t.thisExpression();}return t.objectProperty(key, value, false);});var replacement = t.objectExpression(properties);replacement[$handled] = true;emptyStatement.replaceWith(replacement);}, /*"TemplateLiteral|StringLiteral"(item){
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    },*/"VariableDeclaration|Function|AssignmentExpression|UpdateExpression|YieldExpression|ReturnStatement": function VariableDeclarationFunctionAssignmentExpressionUpdateExpressionYieldExpressionReturnStatement(item) {throw path.buildCodeFrameError("Logging statements cannot have side effects. ".concat(item.type));}, ExpressionStatement: function ExpressionStatement(statement) {if (statement.node[$handled]) {return;}var targetNode = statement.get('expression').node;var messageElements = [];if (targetNode.type === 'SequenceExpression') {var properties = _.chain(targetNode.expressions).map(function (expressionNode) {if (['Identifier', 'ThisExpression'].indexOf(expressionNode.type) > -1) {var varName = expressionNode.type === 'Identifier' ? expressionNode.name : 'this';var key = t.Identifier(varName);var value;if (expressionNode.type === 'Identifier') {value = t.Identifier(varName);} else {value = t.thisExpression();}return t.objectProperty(key, value, false);} else if (['StringLiteral', 'TemplateLiteral'].indexOf(expressionNode.type) > -1) {messageElements.push(expressionNode);}}).compact().value();if (_.isEmpty(properties) && !_.isEmpty(messageElements)) {var _properties = _.map(variables, function (varName) {var key = t.Identifier(varName);var value;if (varName != 'this') {value = t.Identifier(varName);} else {value = t.thisExpression();}return t.objectProperty(key, value, false);});targetNode = t.objectExpression(_properties);} else targetNode = t.objectExpression(properties);} else if (['TemplateLiteral', 'StringLiteral'].indexOf(targetNode.type) > -1) {messageElements.push(targetNode);var _properties2 = _.map(variables, function (varName) {var key = t.Identifier(varName);var value;if (varName != 'this') {value = t.Identifier(varName);} else {value = t.thisExpression();}return t.objectProperty(key, value, false);});targetNode = t.objectExpression(_properties2);}var messageExpression = t.callExpression(t.memberExpression(t.arrayExpression(messageElements), //object
      t.identifier('join'), //property
      false //computed
      ), [t.stringLiteral(' ')]);var message = { messageExpression: messageExpression, prefix: t.stringLiteral(metadata.prefix), content: targetNode, hasStartMessage: t.booleanLiteral(metadata.hasStartMessage), isStartMessage: t.booleanLiteral(metadata.isStartMessage), indent: t.numericLiteral(metadata.indent), parentName: t.stringLiteral(metadata.parentName), filename: t.stringLiteral(metadata.filename), dirname: t.stringLiteral(metadata.dirname), basename: t.stringLiteral(metadata.basename), extname: t.stringLiteral(metadata.extname) };var replacement = t.expressionStatement(alias(message, metadata));replacement[$handled] = true;statement.replaceWith(replacement);} });if (path.node) {if (path.get('body').isBlockStatement()) {path.replaceWithMultiple(path.get('body').node.body);} else {path.replaceWith(path.get('body').node);}}}var wrapVmRunner = template("\nvar VM_RUNNER_RUN_ID = '';\n\nfunction generateUid(){\n    var u='',i=0; var four = 4;\n    var pattern = 'xxxxxxxx-xxxx-'+four+'xxx-yxxx-xxxxxxxxxxxx';\n    while(i++<36) {\n        var c=pattern[i-1],\n        r=Math.random()*16|0,v=c=='x'?r:(r&0x3|0x8);\n        u+=(c=='-'||c==four)?c:v.toString(16)\n    }\n    return u;\n} \n\nif( typeof(vm2Options)==='undefined' ){\n  vm2Options = {};\n}\nvar VM_RUNNER_HASH = vm2Options.VM_RUNNER_HASH;\n\nvar customOptions = vm2Options.customOptions || {};\nvar traceOptions = customOptions.trace||{};\n\nvar VM_RUNNER_TRACE = function(logLevel,prefix,message,data){\n    var alias = traceOptions && traceOptions.aliases && traceOptions.aliases[logLevel] ;\n    var expression = (typeof vm2Options )!=='undefined' ? vm2Options.expression : null;\n    var messageObj = {\n        frame:vmCodeFrame(expression,this.line),\n        prefix:prefix,\n        message:message,\n        logLevel:logLevel,\n        data:data,\n        line:this.line,\n        date:new Date()\n    }\n    if( alias ){\n        return alias.apply(this,[messageObj]);\n    }\n};\n\n\n\nreturn (function vmRunnerWrapper() {\n    VM_RUNNER_RUN_ID = generateUid();\n    \n    BODY;\n}).apply(this);\n");
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9iYWJlbC1wbHVnaW4uanMiXSwibmFtZXMiOlsiZ2V0TG9nRnVuY3Rpb24iLCJoYW5kbGVMYWJlbGVkU3RhdGVtZW50IiwiYmFiZWwiLCJ2aXNpdG9yIiwiUHJvZ3JhbSIsInByb2dyYW0iLCJvcHRzIiwidHJhdmVyc2UiLCJMYWJlbGVkU3RhdGVtZW50IiwicGF0aCIsInZtUnVubmVyV3JhcHBlciIsIndyYXBwZWQiLCJ3cmFwVm1SdW5uZXIiLCJCT0RZIiwibm9kZSIsImJvZHkiLCJWTV9SVU5ORVJfUlVOX0lEIiwidHlwZXMiLCJpZGVudGlmaWVyIiwiVk1fUlVOTkVSX0hBU0giLCJWTV9SVU5ORVJfVFJBQ0UiLCJyZXBsYWNlV2l0aCIsImRpcmVjdGl2ZXMiLCJmc3BhdGgiLCJfIiwidGVtcGxhdGUiLCJnZXQiLCIkaGFuZGxlZCIsIlN5bWJvbCIsIiRub3JtYWxpemVkIiwiUFJFU0VSVkVfQ09OVEVYVFMiLCJub3JtYWxpemVFbnYiLCJwcm9jZXNzIiwiZW52IiwiVFJBQ0VfQ09OVEVYVCIsIlBSRVNFUlZFX0ZJTEVTIiwiVFJBQ0VfRklMRSIsIlBSRVNFUlZFX0xFVkVMUyIsIlRSQUNFX0xFVkVMIiwiaW5wdXQiLCJzcGxpdCIsIm1hcCIsImNvbnRleHQiLCJ0b0xvd2VyQ2FzZSIsInRyaW0iLCJmaWx0ZXIiLCJpZCIsImV4cHJlc3Npb24iLCJmbiIsImlkcyIsImxvZ0xldmVsIiwidCIsImxvZyIsIm1lc3NhZ2UiLCJtZXRhZGF0YSIsIm1lc3NhZ2VFeHByZXNzaW9uIiwicHJlZml4IiwiaW5kZW50IiwiQXJyYXkiLCJqb2luIiwiaXNTZXF1ZW5jZUV4cHJlc3Npb24iLCJjb250ZW50IiwiY2FsbEV4cHJlc3Npb24iLCJtZW1iZXJFeHByZXNzaW9uIiwic3RyaW5nTGl0ZXJhbCIsImNvbmNhdCIsImV4cHJlc3Npb25zIiwiTElORSIsImxvYyIsInN0YXJ0IiwibGluZSIsIkxPR0xFVkVMIiwiUFJFRklYIiwiREFUQSIsIm51bWVyaWNMaXRlcmFsIiwiTUVTU0FHRSIsImdlbmVyYXRlUHJlZml4IiwiZGlybmFtZSIsImJhc2VuYW1lIiwiY29sbGVjdE1ldGFkYXRhIiwiZmlsZW5hbWUiLCJyZXNvbHZlIiwiY3dkIiwiaHViIiwiZmlsZSIsImV4dG5hbWUiLCJuYW1lcyIsInBhcmVudCIsInBhcmVudE5hbWUiLCJnZXRBbmNlc3RyeSIsInNsaWNlIiwicmVkdWNlIiwicGFydHMiLCJpdGVtIiwiaXNDbGFzc01ldGhvZCIsInVuc2hpZnQiLCJrZXkiLCJ0eXBlIiwibmFtZSIsImlzQ2xhc3NEZWNsYXJhdGlvbiIsImlzRnVuY3Rpb24iLCJpc1Byb2dyYW0iLCJpc0NsYXNzQm9keSIsImlzQmxvY2tTdGF0ZW1lbnQiLCJoYXNTdGFydE1lc3NhZ2UiLCJpc1N0YXJ0TWVzc2FnZSIsImNoaWxkIiwiaXNMYWJlbGVkU3RhdGVtZW50IiwibGFiZWwiLCJhbGlhc2VzIiwic2hvdWxkU3RyaXAiLCJzdHJpcCIsInNlIiwiTk9ERV9FTlYiLCJsZW5ndGgiLCJzb21lIiwicGMiLCJpbmNsdWRlcyIsInBmIiwibGV2ZWwiLCJwbCIsIm5vcm1hbGl6ZU9wdHMiLCJ0cmFjZSIsIndhcm4iLCJPYmplY3QiLCJrZXlzIiwiZm9yRWFjaCIsImV4cHIiLCJ1bmRlZmluZWQiLCJwcm9kdWN0aW9uIiwibGFiZWxOYW1lIiwidmFyaWFibGVzIiwibWV0aG9kUGF0aCIsImluZGV4T2YiLCJwdXNoIiwiZWFjaCIsInNjb3BlIiwiYmluZGluZ3MiLCJ2YWwiLCJhbGlhcyIsInJlbW92ZSIsImVtcHR5U3RhdGVtZW50IiwicHJvcGVydGllcyIsInZhck5hbWUiLCJJZGVudGlmaWVyIiwidmFsdWUiLCJ0aGlzRXhwcmVzc2lvbiIsIm9iamVjdFByb3BlcnR5IiwicmVwbGFjZW1lbnQiLCJvYmplY3RFeHByZXNzaW9uIiwiYnVpbGRDb2RlRnJhbWVFcnJvciIsIkV4cHJlc3Npb25TdGF0ZW1lbnQiLCJzdGF0ZW1lbnQiLCJ0YXJnZXROb2RlIiwibWVzc2FnZUVsZW1lbnRzIiwiY2hhaW4iLCJleHByZXNzaW9uTm9kZSIsImNvbXBhY3QiLCJpc0VtcHR5IiwiYXJyYXlFeHByZXNzaW9uIiwiYm9vbGVhbkxpdGVyYWwiLCJleHByZXNzaW9uU3RhdGVtZW50IiwicmVwbGFjZVdpdGhNdWx0aXBsZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFzQ2dCQSxjLEdBQUFBLGM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBNElBQyxzQixHQUFBQSxzQjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBd05ELFVBQVVDLEtBQVYsRUFBaUI7QUFDNUIsU0FBTztBQUNIQyxJQUFBQSxPQUFPLEVBQUU7QUFDTEMsTUFBQUEsT0FESyxtQkFDSUMsT0FESixTQUNxQixLQUFQQyxJQUFPLFNBQVBBLElBQU87QUFDdEJELFFBQUFBLE9BQU8sQ0FBQ0UsUUFBUixDQUFrQjtBQUNkQyxVQUFBQSxnQkFEYyw0QkFDSUMsSUFESixFQUNVO0FBQ3BCUixZQUFBQSxzQkFBc0IsQ0FBRUMsS0FBRixFQUFTTyxJQUFULEVBQWVILElBQWYsQ0FBdEI7QUFDSCxXQUhhLEVBQWxCOzs7QUFNQSxZQUFJLENBQUNELE9BQU8sQ0FBQ0ssZUFBYixFQUE4QjtBQUMxQkwsVUFBQUEsT0FBTyxDQUFDSyxlQUFSLEdBQTBC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SSxDQUFDaUIsR0FBTCxDQUFVLE1BQVYsRUFBa0I2RSxnQkFBbEIsRUFBSixFQUEyQyxDQUN2QzlGLElBQUksQ0FBQ3lKLG1CQUFMLENBQTBCekosSUFBSSxDQUFDaUIsR0FBTCxDQUFVLE1BQVYsRUFBa0JaLElBQWxCLENBQXVCQyxJQUFqRCxFQUNILENBRkQsTUFFTyxDQUNITixJQUFJLENBQUNZLFdBQUwsQ0FBa0JaLElBQUksQ0FBQ2lCLEdBQUwsQ0FBVSxNQUFWLEVBQWtCWixJQUFwQyxFQUNILENBQ0osQ0FDSixDQUNELElBQU1GLFlBQVksR0FBR2EsUUFBUSxtc0NBQTdCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGZzcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IF8gZnJvbSAndW5kZXJzY29yZSc7XG5pbXBvcnQgdGVtcGxhdGUgZnJvbSBcIkBiYWJlbC90ZW1wbGF0ZVwiO1xuaW1wb3J0IHtnZXR9IGZyb20gJ2xvZGFzaCc7XG5cbmNvbnN0ICRoYW5kbGVkID0gU3ltYm9sICgnaGFuZGxlZCcpO1xuY29uc3QgJG5vcm1hbGl6ZWQgPSBTeW1ib2wgKCdub3JtYWxpemVkJyk7XG5cbmNvbnN0IFBSRVNFUlZFX0NPTlRFWFRTID0gbm9ybWFsaXplRW52IChwcm9jZXNzLmVudi5UUkFDRV9DT05URVhUKTtcbmNvbnN0IFBSRVNFUlZFX0ZJTEVTID0gbm9ybWFsaXplRW52IChwcm9jZXNzLmVudi5UUkFDRV9GSUxFKTtcbmNvbnN0IFBSRVNFUlZFX0xFVkVMUyA9IG5vcm1hbGl6ZUVudiAocHJvY2Vzcy5lbnYuVFJBQ0VfTEVWRUwpO1xuXG4vKipcbiAqIE5vcm1hbGl6ZSBhbiBlbnZpcm9ubWVudCB2YXJpYWJsZSwgdXNlZCB0byBvdmVycmlkZSBwbHVnaW4gb3B0aW9ucy5cbiAqL1xuZnVuY3Rpb24gbm9ybWFsaXplRW52IChpbnB1dCl7XG4gICAgaWYgKCFpbnB1dCkge1xuICAgICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIHJldHVybiBpbnB1dC5zcGxpdCAoJywnKVxuICAgIC5tYXAgKGNvbnRleHQgPT4gY29udGV4dC50b0xvd2VyQ2FzZSAoKS50cmltICgpKVxuICAgIC5maWx0ZXIgKGlkID0+IGlkKTtcbn1cblxuLyoqXG4gKiBMaWtlIGB0ZW1wbGF0ZSgpYCBidXQgcmV0dXJucyBhbiBleHByZXNzaW9uLCBub3QgYW4gZXhwcmVzc2lvbiBzdGF0ZW1lbnQuXG4gKi9cbmZ1bmN0aW9uIGV4cHJlc3Npb24gKGlucHV0LCB0ZW1wbGF0ZSkge1xuICAgIGNvbnN0IGZuID0gdGVtcGxhdGUgKGlucHV0KTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGlkcykge1xuICAgICAgICBjb25zdCBub2RlID0gZm4gKGlkcyk7XG4gICAgICAgIHJldHVybiBub2RlLmV4cHJlc3Npb24gPyBub2RlLmV4cHJlc3Npb24gOiBub2RlO1xuICAgIH07XG59XG5cbi8qKlxuICogVGhlIGRlZmF1bHQgbG9nKCkgZnVuY3Rpb24uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRMb2dGdW5jdGlvbiAoe3R5cGVzOiB0LCB0ZW1wbGF0ZX0sIGxvZ0xldmVsKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIGxvZyAobWVzc2FnZSwgbWV0YWRhdGEpIHtcbiAgICAgICAgbGV0IG1lc3NhZ2VFeHByZXNzaW9uID0gbWVzc2FnZS5tZXNzYWdlRXhwcmVzc2lvbjtcbiAgICAgICAgbGV0IHByZWZpeCA9IGAke21ldGFkYXRhLmNvbnRleHR9OmA7XG4gICAgICAgIGlmIChtZXRhZGF0YS5pbmRlbnQpIHtcbiAgICAgICAgICAgIHByZWZpeCArPSAobmV3IEFycmF5IChtZXRhZGF0YS5pbmRlbnQgKyAxKSkuam9pbiAoJyAgJyk7XG4gICAgICAgIH1cblxuXG4gICAgICAgIGlmICh0LmlzU2VxdWVuY2VFeHByZXNzaW9uIChtZXNzYWdlLmNvbnRlbnQpKSB7XG4gICAgICAgICAgICByZXR1cm4gdC5jYWxsRXhwcmVzc2lvbiAoXG4gICAgICAgICAgICAgICAgdC5tZW1iZXJFeHByZXNzaW9uIChcbiAgICAgICAgICAgICAgICAgICAgdC5pZGVudGlmaWVyICgnY29uc29sZScpLFxuICAgICAgICAgICAgICAgICAgICB0LmlkZW50aWZpZXIgKGxvZ0xldmVsKVxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgW3Quc3RyaW5nTGl0ZXJhbCAocHJlZml4KV0uY29uY2F0IChtZXNzYWdlLmNvbnRlbnQuZXhwcmVzc2lvbnMpXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgTElORSA9IG1ldGFkYXRhLnBhdGgubm9kZS5sb2Muc3RhcnQubGluZTtcbiAgICAgICAgICAgIHJldHVybiBleHByZXNzaW9uIChgVk1fUlVOTkVSX1RSQUNFLmFwcGx5KHtsaW5lOkxJTkV9LFtMT0dMRVZFTCwgUFJFRklYLCBNRVNTQUdFLCAgREFUQV0pYCwgdGVtcGxhdGUpICh7XG4gICAgICAgICAgICAgICAgTE9HTEVWRUw6IHQuc3RyaW5nTGl0ZXJhbCAobG9nTGV2ZWwpLFxuICAgICAgICAgICAgICAgIFBSRUZJWDogdC5zdHJpbmdMaXRlcmFsIChwcmVmaXgpLFxuICAgICAgICAgICAgICAgIERBVEE6IG1lc3NhZ2UuY29udGVudCxcbiAgICAgICAgICAgICAgICBMSU5FOnQubnVtZXJpY0xpdGVyYWwoTElORSksXG4gICAgICAgICAgICAgICAgVk1fUlVOTkVSX1RSQUNFOnQuaWRlbnRpZmllciAoJ1ZNX1JVTk5FUl9UUkFDRScpLFxuICAgICAgICAgICAgICAgIE1FU1NBR0U6bWVzc2FnZUV4cHJlc3Npb25cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZVByZWZpeCAoZGlybmFtZSwgYmFzZW5hbWUpIHtcbiAgICBpZiAoYmFzZW5hbWUgIT09ICdpbmRleCcpIHtcbiAgICAgICAgcmV0dXJuIGJhc2VuYW1lO1xuICAgIH1cbiAgICBiYXNlbmFtZSA9IGZzcGF0aC5iYXNlbmFtZSAoZGlybmFtZSk7XG4gICAgaWYgKGJhc2VuYW1lICE9PSAnc3JjJyAmJiBiYXNlbmFtZSAhPT0gJ2xpYicpIHtcbiAgICAgICAgcmV0dXJuIGJhc2VuYW1lO1xuICAgIH1cbiAgICByZXR1cm4gZnNwYXRoLmJhc2VuYW1lIChmc3BhdGguZGlybmFtZSAoZGlybmFtZSkpO1xufVxuXG4vKipcbiAqIENvbGxlY3QgdGhlIG1ldGFkYXRhIGZvciBhIGdpdmVuIG5vZGUgcGF0aCwgd2hpY2ggd2lsbCBiZVxuICogbWFkZSBhdmFpbGFibGUgdG8gbG9nZ2luZyBmdW5jdGlvbnMuXG4gKi9cbmZ1bmN0aW9uIGNvbGxlY3RNZXRhZGF0YSAocGF0aCwgb3B0cykge1xuICAgIGNvbnN0IGZpbGVuYW1lID0gZnNwYXRoLnJlc29sdmUgKHByb2Nlc3MuY3dkICgpLCBwYXRoLmh1Yi5maWxlLm9wdHMuZmlsZW5hbWUpO1xuICAgIGNvbnN0IGRpcm5hbWUgPSBmc3BhdGguZGlybmFtZSAoZmlsZW5hbWUpO1xuICAgIGNvbnN0IGV4dG5hbWUgPSBmc3BhdGguZXh0bmFtZSAoZmlsZW5hbWUpO1xuICAgIGNvbnN0IGJhc2VuYW1lID0gZnNwYXRoLmJhc2VuYW1lIChmaWxlbmFtZSwgZXh0bmFtZSk7XG4gICAgY29uc3QgcHJlZml4ID0gZ2VuZXJhdGVQcmVmaXggKGRpcm5hbWUsIGJhc2VuYW1lKTtcbiAgICBjb25zdCBuYW1lcyA9IFtdO1xuICAgIGxldCBpbmRlbnQgPSAwO1xuICAgIGxldCBwYXJlbnQ7XG5cbiAgICBjb25zdCBwYXJlbnROYW1lID0gcGF0aC5nZXRBbmNlc3RyeSAoKS5zbGljZSAoMSkucmVkdWNlICgocGFydHMsIGl0ZW0pID0+IHtcbiAgICAgICAgaWYgKGl0ZW0uaXNDbGFzc01ldGhvZCAoKSkge1xuICAgICAgICAgICAgaWYgKCFwYXJlbnQpIHtcbiAgICAgICAgICAgICAgICBwYXJlbnQgPSBpdGVtO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGFydHMudW5zaGlmdCAoaXRlbS5ub2RlLmtleS50eXBlID09PSAnSWRlbnRpZmllcicgPyBpdGVtLm5vZGUua2V5Lm5hbWUgOiAnW2NvbXB1dGVkIG1ldGhvZF0nKTtcbiAgICAgICAgfSBlbHNlIGlmIChpdGVtLmlzQ2xhc3NEZWNsYXJhdGlvbiAoKSkge1xuICAgICAgICAgICAgaWYgKCFwYXJlbnQpIHtcbiAgICAgICAgICAgICAgICBwYXJlbnQgPSBpdGVtO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGFydHMudW5zaGlmdCAoaXRlbS5ub2RlLmlkID8gaXRlbS5ub2RlLmlkLm5hbWUgOiBgW2Fub255bW91cyBjbGFzc0Ake2l0ZW0ubm9kZS5sb2Muc3RhcnQubGluZX1dYCk7XG4gICAgICAgIH0gZWxzZSBpZiAoaXRlbS5pc0Z1bmN0aW9uICgpKSB7XG4gICAgICAgICAgICBpZiAoIXBhcmVudCkge1xuICAgICAgICAgICAgICAgIHBhcmVudCA9IGl0ZW07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwYXJ0cy51bnNoaWZ0ICgoaXRlbS5ub2RlLmlkICYmIGl0ZW0ubm9kZS5pZC5uYW1lKSB8fCBgW2Fub255bW91c0Ake2l0ZW0ubm9kZS5sb2Muc3RhcnQubGluZX1dYCk7XG4gICAgICAgIH0gZWxzZSBpZiAoaXRlbS5pc1Byb2dyYW0gKCkpIHtcbiAgICAgICAgICAgIGlmICghcGFyZW50KSB7XG4gICAgICAgICAgICAgICAgcGFyZW50ID0gaXRlbTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICghcGFyZW50ICYmICFpdGVtLmlzQ2xhc3NCb2R5ICgpICYmICFpdGVtLmlzQmxvY2tTdGF0ZW1lbnQgKCkpIHtcbiAgICAgICAgICAgIGluZGVudCsrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwYXJ0cztcbiAgICB9LCBbXSkuam9pbiAoJzonKTtcblxuICAgIGxldCBoYXNTdGFydE1lc3NhZ2UgPSBmYWxzZTtcbiAgICBsZXQgaXNTdGFydE1lc3NhZ2UgPSBmYWxzZTtcbiAgICBpZiAocGFyZW50ICYmICFwYXJlbnQuaXNQcm9ncmFtICgpKSB7XG4gICAgICAgIGZvciAobGV0IGNoaWxkIG9mIHBhcmVudC5nZXQgKCdib2R5JykuZ2V0ICgnYm9keScpKSB7XG4gICAgICAgICAgICBpZiAoY2hpbGQubm9kZVskaGFuZGxlZF0pIHtcbiAgICAgICAgICAgICAgICBoYXNTdGFydE1lc3NhZ2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFjaGlsZC5pc0xhYmVsZWRTdGF0ZW1lbnQgKCkpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGxhYmVsID0gY2hpbGQuZ2V0ICgnbGFiZWwnKTtcbiAgICAgICAgICAgIGlmIChvcHRzLmFsaWFzZXNbbGFiZWwubm9kZS5uYW1lXSkge1xuICAgICAgICAgICAgICAgIGhhc1N0YXJ0TWVzc2FnZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkLm5vZGUgPT09IHBhdGgubm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBpc1N0YXJ0TWVzc2FnZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgY29udGV4dCA9IGAke3ByZWZpeH06JHtwYXJlbnROYW1lfWA7XG4gICAgcmV0dXJuIHtpbmRlbnQsIHByZWZpeCwgcGFyZW50TmFtZSwgY29udGV4dCwgaGFzU3RhcnRNZXNzYWdlLCBpc1N0YXJ0TWVzc2FnZSwgZmlsZW5hbWUsIGRpcm5hbWUsIGJhc2VuYW1lLCBleHRuYW1lLCBwYXRofTtcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgd2hldGhlciB0aGUgZ2l2ZW4gbG9nZ2luZyBzdGF0ZW1lbnQgc2hvdWxkIGJlIHN0cmlwcGVkLlxuICovXG5mdW5jdGlvbiBzaG91bGRTdHJpcCAobmFtZSwgbWV0YWRhdGEsIHtzdHJpcH0pIHtcbiAgICBzd2l0Y2ggKHR5cGVvZiBzdHJpcCkge1xuICAgICAgICBjYXNlICdib29sZWFuJzpcbiAgICAgICAgICAgIGlmICghc3RyaXApIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIC8vIHN0cmlwID09PSB0cnVlXG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnb2JqZWN0JzpcbiAgICAgICAgICAgIGNvbnN0IHNlID0gc3RyaXBbbmFtZV07XG4gICAgICAgICAgICBpZiAoIXNlIHx8ICh0eXBlb2Ygc2UgPT09ICdvYmplY3QnICYmICFzZVtwcm9jZXNzLmVudi5OT0RFX0VOVl0pKSByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAvLyBzdHJpcFtuYW1lXSA9PT0gdHJ1ZSB8fCBzdHJpcFtuYW1lXVtlbnZdID09PSB0cnVlXG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKFBSRVNFUlZFX0NPTlRFWFRTLmxlbmd0aCkge1xuICAgICAgICBjb25zdCBjb250ZXh0ID0gbWV0YWRhdGEuY29udGV4dC50b0xvd2VyQ2FzZSAoKTtcbiAgICAgICAgaWYgKFBSRVNFUlZFX0NPTlRFWFRTLnNvbWUgKHBjID0+IGNvbnRleHQuaW5jbHVkZXMgKHBjKSkpIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKFBSRVNFUlZFX0ZJTEVTLmxlbmd0aCkge1xuICAgICAgICBjb25zdCBmaWxlbmFtZSA9IG1ldGFkYXRhLmZpbGVuYW1lLnRvTG93ZXJDYXNlICgpO1xuICAgICAgICBpZiAoUFJFU0VSVkVfRklMRVMuc29tZSAocGYgPT4gZmlsZW5hbWUuaW5jbHVkZXMgKHBmKSkpIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKFBSRVNFUlZFX0xFVkVMUy5sZW5ndGgpIHtcbiAgICAgICAgY29uc3QgbGV2ZWwgPSBuYW1lLnRvTG93ZXJDYXNlICgpO1xuICAgICAgICBpZiAoUFJFU0VSVkVfTEVWRUxTLnNvbWUgKHBsID0+IGxldmVsID09PSBwbCkpIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoYW5kbGVMYWJlbGVkU3RhdGVtZW50IChiYWJlbCwgcGF0aCwgb3B0cykge1xuICAgIGNvbnN0IHQgPSBiYWJlbC50eXBlcztcbiAgICBjb25zdCBsYWJlbCA9IHBhdGguZ2V0ICgnbGFiZWwnKTtcbiAgICBvcHRzID0gKGZ1bmN0aW9uIG5vcm1hbGl6ZU9wdHMgKGJhYmVsLCBvcHRzKSB7XG4gICAgICAgIGlmIChvcHRzWyRub3JtYWxpemVkXSkge1xuICAgICAgICAgICAgcmV0dXJuIG9wdHM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFvcHRzLmFsaWFzZXMpIHtcbiAgICAgICAgICAgIG9wdHMuYWxpYXNlcyA9IHtcbiAgICAgICAgICAgICAgICBsb2c6IGdldExvZ0Z1bmN0aW9uIChiYWJlbCwgJ2xvZycpLFxuICAgICAgICAgICAgICAgIHRyYWNlOiBnZXRMb2dGdW5jdGlvbiAoYmFiZWwsICd0cmFjZScpLFxuICAgICAgICAgICAgICAgIHdhcm46IGdldExvZ0Z1bmN0aW9uIChiYWJlbCwgJ3dhcm4nKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIE9iamVjdC5rZXlzIChvcHRzLmFsaWFzZXMpLmZvckVhY2ggKGtleSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBvcHRzLmFsaWFzZXNba2V5XSA9PT0gJ3N0cmluZycgJiYgb3B0cy5hbGlhc2VzW2tleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhwciA9IGV4cHJlc3Npb24gKG9wdHMuYWxpYXNlc1trZXldLCBiYWJlbC50ZW1wbGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIG9wdHMuYWxpYXNlc1trZXldID0gKG1lc3NhZ2UpID0+IGV4cHIgKG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRzLnN0cmlwID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIG9wdHMuc3RyaXAgPSB7XG4gICAgICAgICAgICAgICAgbG9nOiB7cHJvZHVjdGlvbjogdHJ1ZX0sXG4gICAgICAgICAgICAgICAgdHJhY2U6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHdhcm46IHtwcm9kdWN0aW9uOiB0cnVlfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBvcHRzWyRub3JtYWxpemVkXSA9IHRydWU7XG4gICAgICAgIHJldHVybiBvcHRzO1xuICAgIH0pKGJhYmVsLCBvcHRzKTtcblxuICAgIGNvbnN0IGxhYmVsTmFtZSA9IGxhYmVsLm5vZGUubmFtZTtcbiAgICBjb25zdCB2YXJpYWJsZXMgPSAgW107XG5cbiAgICBjb25zdCBtZXRob2RQYXRoID0gZ2V0KHBhdGgsJ3BhcmVudFBhdGgucGFyZW50UGF0aCcsbnVsbCk7XG4gICAgaWYobWV0aG9kUGF0aCAmJlsnQ2xhc3NNZXRob2QnLCdPYmplY3RNZXRob2QnXS5pbmRleE9mKG1ldGhvZFBhdGgudHlwZSk+LTEmJiFtZXRob2RQYXRoLm5vZGUuc3RhdGljKXtcbiAgICAgICAgdmFyaWFibGVzLnB1c2goJ3RoaXMnKTtcbiAgICB9XG4gICAgXy5lYWNoKCBwYXRoLnNjb3BlLmJpbmRpbmdzICwgKHZhbCxrZXkpPT57XG4gICAgICAgIGlmKHZhcmlhYmxlcy5pbmRleE9mKGtleSk9PS0xKVxuICAgICAgICAgICAgdmFyaWFibGVzLnB1c2goa2V5KTtcbiAgICB9KTtcblxuXG4gICAgY29uc3QgYWxpYXMgPSBvcHRzLmFsaWFzZXNbbGFiZWxOYW1lXVxuICAgIGlmICghYWxpYXMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBtZXRhZGF0YSA9IGNvbGxlY3RNZXRhZGF0YSAocGF0aCwgb3B0cyk7XG4gICAgaWYgKHNob3VsZFN0cmlwIChsYWJlbC5ub2RlLm5hbWUsIG1ldGFkYXRhLCBvcHRzKSkge1xuICAgICAgICBwYXRoLnJlbW92ZSAoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHBhdGgudHJhdmVyc2UgKHtcbiAgICAgICAgXCJFbXB0eVN0YXRlbWVudFwiIChlbXB0eVN0YXRlbWVudCl7XG4gICAgICAgICAgICBsZXQgcHJvcGVydGllcyA9IF8ubWFwICh2YXJpYWJsZXMsICh2YXJOYW1lKSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGtleSA9IHQuSWRlbnRpZmllciAodmFyTmFtZSk7XG4gICAgICAgICAgICAgICAgbGV0IHZhbHVlO1xuICAgICAgICAgICAgICAgIGlmKHZhck5hbWUhPSd0aGlzJykge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHQuSWRlbnRpZmllciAodmFyTmFtZSk7XG4gICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdC50aGlzRXhwcmVzc2lvbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdC5vYmplY3RQcm9wZXJ0eSAoa2V5LCB2YWx1ZSwgZmFsc2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBsZXQgcmVwbGFjZW1lbnQgPSB0Lm9iamVjdEV4cHJlc3Npb24gKHByb3BlcnRpZXMpO1xuICAgICAgICAgICAgcmVwbGFjZW1lbnRbJGhhbmRsZWRdID0gdHJ1ZTtcbiAgICAgICAgICAgIGVtcHR5U3RhdGVtZW50LnJlcGxhY2VXaXRoIChyZXBsYWNlbWVudCk7XG4gICAgICAgIH0sXG4gICAgICAgIC8qXCJUZW1wbGF0ZUxpdGVyYWx8U3RyaW5nTGl0ZXJhbFwiKGl0ZW0pe1xuXG4gICAgICAgIH0sKi9cbiAgICAgICAgXCJWYXJpYWJsZURlY2xhcmF0aW9ufEZ1bmN0aW9ufEFzc2lnbm1lbnRFeHByZXNzaW9ufFVwZGF0ZUV4cHJlc3Npb258WWllbGRFeHByZXNzaW9ufFJldHVyblN0YXRlbWVudFwiIChpdGVtKSB7XG4gICAgICAgICAgICB0aHJvdyBwYXRoLmJ1aWxkQ29kZUZyYW1lRXJyb3IgKGBMb2dnaW5nIHN0YXRlbWVudHMgY2Fubm90IGhhdmUgc2lkZSBlZmZlY3RzLiAke2l0ZW0udHlwZX1gKTtcbiAgICAgICAgfSxcbiAgICAgICAgRXhwcmVzc2lvblN0YXRlbWVudCAoc3RhdGVtZW50KSB7XG4gICAgICAgICAgICBpZiAoc3RhdGVtZW50Lm5vZGVbJGhhbmRsZWRdKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IHRhcmdldE5vZGUgPSBzdGF0ZW1lbnQuZ2V0ICgnZXhwcmVzc2lvbicpLm5vZGU7XG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlRWxlbWVudHMgPSBbXTtcbiAgICAgICAgICAgIGlmKHRhcmdldE5vZGUudHlwZT09PSdTZXF1ZW5jZUV4cHJlc3Npb24nKXtcbiAgICAgICAgICAgICAgICBsZXQgcHJvcGVydGllcyA9IF8uY2hhaW4odGFyZ2V0Tm9kZS5leHByZXNzaW9ucykubWFwKChleHByZXNzaW9uTm9kZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZihbJ0lkZW50aWZpZXInLCdUaGlzRXhwcmVzc2lvbiddLmluZGV4T2YoZXhwcmVzc2lvbk5vZGUudHlwZSk+LTEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZhck5hbWUgPSBleHByZXNzaW9uTm9kZS50eXBlPT09J0lkZW50aWZpZXInP2V4cHJlc3Npb25Ob2RlLm5hbWU6J3RoaXMnO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGtleSA9IHQuSWRlbnRpZmllciAodmFyTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihleHByZXNzaW9uTm9kZS50eXBlPT09J0lkZW50aWZpZXInKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB0LklkZW50aWZpZXIgKHZhck5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB0LnRoaXNFeHByZXNzaW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5vYmplY3RQcm9wZXJ0eSAoa2V5LCB2YWx1ZSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB9ZWxzZSBpZihbJ1N0cmluZ0xpdGVyYWwnLCdUZW1wbGF0ZUxpdGVyYWwnXS5pbmRleE9mKGV4cHJlc3Npb25Ob2RlLnR5cGUpPi0xKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VFbGVtZW50cy5wdXNoKGV4cHJlc3Npb25Ob2RlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLmNvbXBhY3QoKS52YWx1ZSgpO1xuICAgICAgICAgICAgICAgIGlmKCBfLmlzRW1wdHkocHJvcGVydGllcykgJiYgIV8uaXNFbXB0eShtZXNzYWdlRWxlbWVudHMpICl7XG4gICAgICAgICAgICAgICAgICAgIGxldCBwcm9wZXJ0aWVzID0gXy5tYXAgKHZhcmlhYmxlcywgKHZhck5hbWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBrZXkgPSB0LklkZW50aWZpZXIgKHZhck5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYodmFyTmFtZSE9J3RoaXMnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB0LklkZW50aWZpZXIgKHZhck5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB0LnRoaXNFeHByZXNzaW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5vYmplY3RQcm9wZXJ0eSAoa2V5LCB2YWx1ZSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Tm9kZSA9IHQub2JqZWN0RXhwcmVzc2lvbiAocHJvcGVydGllcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Tm9kZSA9IHQub2JqZWN0RXhwcmVzc2lvbiAocHJvcGVydGllcyk7XG4gICAgICAgICAgICB9ZWxzZSBpZihbJ1RlbXBsYXRlTGl0ZXJhbCcsJ1N0cmluZ0xpdGVyYWwnXS5pbmRleE9mKHRhcmdldE5vZGUudHlwZSk+LTEpe1xuICAgICAgICAgICAgICAgIG1lc3NhZ2VFbGVtZW50cy5wdXNoKHRhcmdldE5vZGUpO1xuXG4gICAgICAgICAgICAgICAgbGV0IHByb3BlcnRpZXMgPSBfLm1hcCAodmFyaWFibGVzLCAodmFyTmFtZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBsZXQga2V5ID0gdC5JZGVudGlmaWVyICh2YXJOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBpZih2YXJOYW1lIT0ndGhpcycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdC5JZGVudGlmaWVyICh2YXJOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHQudGhpc0V4cHJlc3Npb24oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5vYmplY3RQcm9wZXJ0eSAoa2V5LCB2YWx1ZSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRhcmdldE5vZGUgPSB0Lm9iamVjdEV4cHJlc3Npb24gKHByb3BlcnRpZXMpO1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VFeHByZXNzaW9uID0gdC5jYWxsRXhwcmVzc2lvbihcbiAgICAgICAgICAgICAgICB0Lm1lbWJlckV4cHJlc3Npb24oXG4gICAgICAgICAgICAgICAgICAgIHQuYXJyYXlFeHByZXNzaW9uKG1lc3NhZ2VFbGVtZW50cyksLy9vYmplY3RcbiAgICAgICAgICAgICAgICAgICAgdC5pZGVudGlmaWVyKCdqb2luJyksLy9wcm9wZXJ0eVxuICAgICAgICAgICAgICAgICAgICBmYWxzZS8vY29tcHV0ZWRcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgLCBbXG4gICAgICAgICAgICAgICAgICAgIHQuc3RyaW5nTGl0ZXJhbCgnICcpXG4gICAgICAgICAgICAgICAgXSk7XG5cbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZUV4cHJlc3Npb24sXG4gICAgICAgICAgICAgICAgcHJlZml4OiB0LnN0cmluZ0xpdGVyYWwgKG1ldGFkYXRhLnByZWZpeCksXG4gICAgICAgICAgICAgICAgY29udGVudDogdGFyZ2V0Tm9kZSxcbiAgICAgICAgICAgICAgICBoYXNTdGFydE1lc3NhZ2U6IHQuYm9vbGVhbkxpdGVyYWwgKG1ldGFkYXRhLmhhc1N0YXJ0TWVzc2FnZSksXG4gICAgICAgICAgICAgICAgaXNTdGFydE1lc3NhZ2U6IHQuYm9vbGVhbkxpdGVyYWwgKG1ldGFkYXRhLmlzU3RhcnRNZXNzYWdlKSxcbiAgICAgICAgICAgICAgICBpbmRlbnQ6IHQubnVtZXJpY0xpdGVyYWwgKG1ldGFkYXRhLmluZGVudCksXG4gICAgICAgICAgICAgICAgcGFyZW50TmFtZTogdC5zdHJpbmdMaXRlcmFsIChtZXRhZGF0YS5wYXJlbnROYW1lKSxcbiAgICAgICAgICAgICAgICBmaWxlbmFtZTogdC5zdHJpbmdMaXRlcmFsIChtZXRhZGF0YS5maWxlbmFtZSksXG4gICAgICAgICAgICAgICAgZGlybmFtZTogdC5zdHJpbmdMaXRlcmFsIChtZXRhZGF0YS5kaXJuYW1lKSxcbiAgICAgICAgICAgICAgICBiYXNlbmFtZTogdC5zdHJpbmdMaXRlcmFsIChtZXRhZGF0YS5iYXNlbmFtZSksXG4gICAgICAgICAgICAgICAgZXh0bmFtZTogdC5zdHJpbmdMaXRlcmFsIChtZXRhZGF0YS5leHRuYW1lKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNvbnN0IHJlcGxhY2VtZW50ID0gdC5leHByZXNzaW9uU3RhdGVtZW50IChhbGlhcyAobWVzc2FnZSwgbWV0YWRhdGEpKTtcbiAgICAgICAgICAgIHJlcGxhY2VtZW50WyRoYW5kbGVkXSA9IHRydWU7XG4gICAgICAgICAgICBzdGF0ZW1lbnQucmVwbGFjZVdpdGggKHJlcGxhY2VtZW50KTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKHBhdGgubm9kZSkge1xuICAgICAgICBpZiAocGF0aC5nZXQgKCdib2R5JykuaXNCbG9ja1N0YXRlbWVudCAoKSkge1xuICAgICAgICAgICAgcGF0aC5yZXBsYWNlV2l0aE11bHRpcGxlIChwYXRoLmdldCAoJ2JvZHknKS5ub2RlLmJvZHkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcGF0aC5yZXBsYWNlV2l0aCAocGF0aC5nZXQgKCdib2R5Jykubm9kZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5jb25zdCB3cmFwVm1SdW5uZXIgPSB0ZW1wbGF0ZSAoYFxudmFyIFZNX1JVTk5FUl9SVU5fSUQgPSAnJztcblxuZnVuY3Rpb24gZ2VuZXJhdGVVaWQoKXtcbiAgICB2YXIgdT0nJyxpPTA7IHZhciBmb3VyID0gNDtcbiAgICB2YXIgcGF0dGVybiA9ICd4eHh4eHh4eC14eHh4LScrZm91cisneHh4LXl4eHgteHh4eHh4eHh4eHh4JztcbiAgICB3aGlsZShpKys8MzYpIHtcbiAgICAgICAgdmFyIGM9cGF0dGVybltpLTFdLFxuICAgICAgICByPU1hdGgucmFuZG9tKCkqMTZ8MCx2PWM9PSd4Jz9yOihyJjB4M3wweDgpO1xuICAgICAgICB1Kz0oYz09Jy0nfHxjPT1mb3VyKT9jOnYudG9TdHJpbmcoMTYpXG4gICAgfVxuICAgIHJldHVybiB1O1xufSBcblxuaWYoIHR5cGVvZih2bTJPcHRpb25zKT09PSd1bmRlZmluZWQnICl7XG4gIHZtMk9wdGlvbnMgPSB7fTtcbn1cbnZhciBWTV9SVU5ORVJfSEFTSCA9IHZtMk9wdGlvbnMuVk1fUlVOTkVSX0hBU0g7XG5cbnZhciBjdXN0b21PcHRpb25zID0gdm0yT3B0aW9ucy5jdXN0b21PcHRpb25zIHx8IHt9O1xudmFyIHRyYWNlT3B0aW9ucyA9IGN1c3RvbU9wdGlvbnMudHJhY2V8fHt9O1xuXG52YXIgVk1fUlVOTkVSX1RSQUNFID0gZnVuY3Rpb24obG9nTGV2ZWwscHJlZml4LG1lc3NhZ2UsZGF0YSl7XG4gICAgdmFyIGFsaWFzID0gdHJhY2VPcHRpb25zICYmIHRyYWNlT3B0aW9ucy5hbGlhc2VzICYmIHRyYWNlT3B0aW9ucy5hbGlhc2VzW2xvZ0xldmVsXSA7XG4gICAgdmFyIGV4cHJlc3Npb24gPSAodHlwZW9mIHZtMk9wdGlvbnMgKSE9PSd1bmRlZmluZWQnID8gdm0yT3B0aW9ucy5leHByZXNzaW9uIDogbnVsbDtcbiAgICB2YXIgbWVzc2FnZU9iaiA9IHtcbiAgICAgICAgZnJhbWU6dm1Db2RlRnJhbWUoZXhwcmVzc2lvbix0aGlzLmxpbmUpLFxuICAgICAgICBwcmVmaXg6cHJlZml4LFxuICAgICAgICBtZXNzYWdlOm1lc3NhZ2UsXG4gICAgICAgIGxvZ0xldmVsOmxvZ0xldmVsLFxuICAgICAgICBkYXRhOmRhdGEsXG4gICAgICAgIGxpbmU6dGhpcy5saW5lLFxuICAgICAgICBkYXRlOm5ldyBEYXRlKClcbiAgICB9XG4gICAgaWYoIGFsaWFzICl7XG4gICAgICAgIHJldHVybiBhbGlhcy5hcHBseSh0aGlzLFttZXNzYWdlT2JqXSk7XG4gICAgfVxufTtcblxuXG5cbnJldHVybiAoZnVuY3Rpb24gdm1SdW5uZXJXcmFwcGVyKCkge1xuICAgIFZNX1JVTk5FUl9SVU5fSUQgPSBnZW5lcmF0ZVVpZCgpO1xuICAgIFxuICAgIEJPRFk7XG59KS5hcHBseSh0aGlzKTtcbmApO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiAoYmFiZWwpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICB2aXNpdG9yOiB7XG4gICAgICAgICAgICBQcm9ncmFtIChwcm9ncmFtLCB7b3B0c30pIHtcbiAgICAgICAgICAgICAgICBwcm9ncmFtLnRyYXZlcnNlICh7XG4gICAgICAgICAgICAgICAgICAgIExhYmVsZWRTdGF0ZW1lbnQgKHBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUxhYmVsZWRTdGF0ZW1lbnQgKGJhYmVsLCBwYXRoLCBvcHRzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFwcm9ncmFtLnZtUnVubmVyV3JhcHBlcikge1xuICAgICAgICAgICAgICAgICAgICBwcm9ncmFtLnZtUnVubmVyV3JhcHBlciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHZhciB3cmFwcGVkID0gd3JhcFZtUnVubmVyICh7XG4gICAgICAgICAgICAgICAgICAgICAgICBCT0RZOiBwcm9ncmFtLm5vZGUuYm9keSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFZNX1JVTk5FUl9SVU5fSUQ6YmFiZWwudHlwZXMuaWRlbnRpZmllciAoJ1ZNX1JVTk5FUl9SVU5fSUQnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFZNX1JVTk5FUl9IQVNIOmJhYmVsLnR5cGVzLmlkZW50aWZpZXIgKCdWTV9SVU5ORVJfSEFTSCcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgVk1fUlVOTkVSX1RSQUNFOmJhYmVsLnR5cGVzLmlkZW50aWZpZXIgKCdWTV9SVU5ORVJfVFJBQ0UnKSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgcHJvZ3JhbS5yZXBsYWNlV2l0aCAoXG4gICAgICAgICAgICAgICAgICAgICAgICBiYWJlbC50eXBlcy5wcm9ncmFtICh3cmFwcGVkKVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwcm9ncmFtLm5vZGUuZGlyZWN0aXZlcyA9IFtdO1xuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufVxuIl19