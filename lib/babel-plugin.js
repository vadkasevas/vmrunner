"use strict";var _interopRequireDefault3 = require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireDefault2 = _interopRequireDefault3(require("@babel/runtime/helpers/interopRequireDefault"));Object.defineProperty(exports, "__esModule", { value: true });var _typeof2 = require("@babel/runtime/helpers/typeof");var _typeof = (0, _interopRequireDefault2["default"])(_typeof2)["default"];exports.





































getLogFunction = getLogFunction;exports.











































































































































handleLabeledStatement = handleLabeledStatement;exports["default"] =




























































































































































































































function (babel) {
  return {
    visitor: {
      Program: function Program(program, _ref3) {var opts = _ref3.opts;
        program.traverse({
          LabeledStatement: function LabeledStatement(path) {
            handleLabeledStatement(babel, path, opts);
          } });


        if (!program.vmRunnerWrapper) {
          program.vmRunnerWrapper = true;
          var wrapped = wrapVmRunner({
            BODY: program.node.body,
            VM_RUNNER_RUN_ID: babel.types.identifier('VM_RUNNER_RUN_ID'),
            VM_RUNNER_HASH: babel.types.identifier('VM_RUNNER_HASH'),
            VM_RUNNER_TRACE: babel.types.identifier('VM_RUNNER_TRACE') });


          program.replaceWith(
          babel.types.program(wrapped));

        }
        program.node.directives = [];

      } } };


};var _path = require("path");var fspath = (0, _interopRequireDefault2["default"])(_path)["default"];var _underscore = require("underscore");var _ = (0, _interopRequireDefault2["default"])(_underscore)["default"];var _template = require("@babel/template");var template = (0, _interopRequireDefault2["default"])(_template)["default"];var _lodash = require("lodash");var get = _lodash.get;var $handled = Symbol('handled');var $normalized = Symbol('normalized');var PRESERVE_CONTEXTS = normalizeEnv(process.env.TRACE_CONTEXT);var PRESERVE_FILES = normalizeEnv(process.env.TRACE_FILE);var PRESERVE_LEVELS = normalizeEnv(process.env.TRACE_LEVEL); /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Normalize an environment variable, used to override plugin options.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   */function normalizeEnv(input) {if (!input) {return [];}return input.split(',').map(function (context) {return context.toLowerCase().trim();}).filter(function (id) {return id;});} /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Like `template()` but returns an expression, not an expression statement.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        */function expression(input, template) {var fn = template(input);return function (ids) {var node = fn(ids);return node.expression ? node.expression : node;};} /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * The default log() function.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        */function getLogFunction(_ref, logLevel) {var t = _ref.types,template = _ref.template;return function log(message, metadata) {var messageExpression = message.messageExpression;var prefix = "".concat(metadata.context, ":");if (metadata.indent) {prefix += new Array(metadata.indent + 1).join('  ');}if (t.isSequenceExpression(message.content)) {return t.callExpression(t.memberExpression(t.identifier('console'), t.identifier(logLevel)), [t.stringLiteral(prefix)].concat(message.content.expressions));} else {var LINE = metadata.path.node.loc.start.line;return expression("VM_RUNNER_TRACE.apply({line:LINE},[LOGLEVEL, PREFIX, MESSAGE,  DATA])", template)({ LOGLEVEL: t.stringLiteral(logLevel), PREFIX: t.stringLiteral(prefix), DATA: message.content, LINE: t.numericLiteral(LINE), VM_RUNNER_TRACE: t.identifier('VM_RUNNER_TRACE'), MESSAGE: messageExpression });}};}function generatePrefix(dirname, basename) {if (basename !== 'index') {return basename;}basename = fspath.basename(dirname);if (basename !== 'src' && basename !== 'lib') {return basename;}return fspath.basename(fspath.dirname(dirname));} /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Collect the metadata for a given node path, which will be
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * made available to logging functions.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */function collectMetadata(path, opts) {var filename = fspath.resolve(process.cwd(), path.hub.file.opts.filename);var dirname = fspath.dirname(filename);var extname = fspath.extname(filename);var basename = fspath.basename(filename, extname);var prefix = generatePrefix(dirname, basename);var names = [];var indent = 0;var parent;var parentName = path.getAncestry().slice(1).reduce(function (parts, item) {if (item.isClassMethod()) {if (!parent) {parent = item;}parts.unshift(item.node.key.type === 'Identifier' ? item.node.key.name : '[computed method]');} else if (item.isClassDeclaration()) {if (!parent) {parent = item;}parts.unshift(item.node.id ? item.node.id.name : "[anonymous class@".concat(item.node.loc.start.line, "]"));} else if (item.isFunction()) {if (!parent) {parent = item;}parts.unshift(item.node.id && item.node.id.name || "[anonymous@".concat(item.node.loc.start.line, "]"));} else if (item.isProgram()) {if (!parent) {parent = item;}} else if (!parent && !item.isClassBody() && !item.isBlockStatement()) {indent++;}return parts;}, []).join(':');var hasStartMessage = false;var isStartMessage = false;if (parent && !parent.isProgram()) {var _iteratorNormalCompletion = true;var _didIteratorError = false;var _iteratorError = undefined;try {for (var _iterator = parent.get('body').get('body')[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {var child = _step.value;if (child.node[$handled]) {hasStartMessage = true;break;}if (!child.isLabeledStatement()) {break;}var label = child.get('label');if (opts.aliases[label.node.name]) {hasStartMessage = true;if (child.node === path.node) {isStartMessage = true;}break;}}} catch (err) {_didIteratorError = true;_iteratorError = err;} finally {try {if (!_iteratorNormalCompletion && _iterator["return"] != null) {_iterator["return"]();}} finally {if (_didIteratorError) {throw _iteratorError;}}}}var context = "".concat(prefix, ":").concat(parentName);return { indent: indent, prefix: prefix, parentName: parentName, context: context, hasStartMessage: hasStartMessage, isStartMessage: isStartMessage, filename: filename, dirname: dirname, basename: basename, extname: extname, path: path };} /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Determine whether the given logging statement should be stripped.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */function shouldStrip(name, metadata, _ref2) {var strip = _ref2.strip;switch (_typeof(strip)) {case 'boolean':if (!strip) return false; // strip === true
      break;case 'object':var se = strip[name];if (!se || _typeof(se) === 'object' && !se[process.env.NODE_ENV]) return false; // strip[name] === true || strip[name][env] === true
      break;default:return false;}if (PRESERVE_CONTEXTS.length) {var context = metadata.context.toLowerCase();if (PRESERVE_CONTEXTS.some(function (pc) {return context.includes(pc);})) return false;}if (PRESERVE_FILES.length) {var filename = metadata.filename.toLowerCase();if (PRESERVE_FILES.some(function (pf) {return filename.includes(pf);})) return false;}if (PRESERVE_LEVELS.length) {var level = name.toLowerCase();if (PRESERVE_LEVELS.some(function (pl) {return level === pl;})) return false;}return true;}function handleLabeledStatement(babel, path, opts) {var t = babel.types;var label = path.get('label');opts = function normalizeOpts(babel, opts) {if (opts[$normalized]) {return opts;}if (!opts.aliases) {opts.aliases = { log: getLogFunction(babel, 'log'), trace: getLogFunction(babel, 'trace'), warn: getLogFunction(babel, 'warn'), error: getLogFunction(babel, 'error'), debug: getLogFunction(babel, 'debug') };} else {Object.keys(opts.aliases).forEach(function (key) {if (typeof opts.aliases[key] === 'string' && opts.aliases[key]) {var expr = expression(opts.aliases[key], babel.template);opts.aliases[key] = function (message) {return expr(message);};}});}if (opts.strip === undefined) {opts.strip = { log: { production: true }, trace: false, warn: { production: true } };}opts[$normalized] = true;return opts;}(babel, opts);var labelName = label.node.name;var variables = [];var methodPath = get(path, 'parentPath.parentPath', null);if (methodPath && ['ClassMethod', 'ObjectMethod'].indexOf(methodPath.type) > -1 && !methodPath.node["static"]) {variables.push('this');}_.each(path.scope.bindings, function (val, key) {if (variables.indexOf(key) == -1) variables.push(key);});var alias = opts.aliases[labelName];if (!alias) {return;}var metadata = collectMetadata(path, opts);if (shouldStrip(label.node.name, metadata, opts)) {path.remove();return;}path.traverse({ "EmptyStatement": function EmptyStatement(emptyStatement) {var properties = _.map(variables, function (varName) {var key = t.Identifier(varName);var value;if (varName != 'this') {value = t.Identifier(varName);} else {value = t.thisExpression();}return t.objectProperty(key, value, false);});var replacement = t.objectExpression(properties);replacement[$handled] = true;emptyStatement.replaceWith(replacement);}, /*"TemplateLiteral|StringLiteral"(item){
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  },*/"VariableDeclaration|Function|AssignmentExpression|UpdateExpression|YieldExpression|ReturnStatement": function VariableDeclarationFunctionAssignmentExpressionUpdateExpressionYieldExpressionReturnStatement(item) {throw path.buildCodeFrameError("Logging statements cannot have side effects. ".concat(item.type));}, ExpressionStatement: function ExpressionStatement(statement) {if (statement.node[$handled]) {return;}var targetNode = statement.get('expression').node;var messageElements = [];if (targetNode.type === 'SequenceExpression') {var properties = _.chain(targetNode.expressions).map(function (expressionNode) {if (['Identifier', 'ThisExpression'].indexOf(expressionNode.type) > -1) {var varName = expressionNode.type === 'Identifier' ? expressionNode.name : 'this';var key = t.Identifier(varName);var value;if (expressionNode.type === 'Identifier') {value = t.Identifier(varName);} else {value = t.thisExpression();}return t.objectProperty(key, value, false);} else if (['StringLiteral', 'TemplateLiteral'].indexOf(expressionNode.type) > -1) {messageElements.push(expressionNode);}}).compact().value();if (_.isEmpty(properties) && !_.isEmpty(messageElements)) {var _properties = _.map(variables, function (varName) {var key = t.Identifier(varName);var value;if (varName != 'this') {value = t.Identifier(varName);} else {value = t.thisExpression();}return t.objectProperty(key, value, false);});targetNode = t.objectExpression(_properties);} else targetNode = t.objectExpression(properties);} else if (['TemplateLiteral', 'StringLiteral'].indexOf(targetNode.type) > -1) {messageElements.push(targetNode);var _properties2 = _.map(variables, function (varName) {var key = t.Identifier(varName);var value;if (varName != 'this') {value = t.Identifier(varName);} else {value = t.thisExpression();}return t.objectProperty(key, value, false);});targetNode = t.objectExpression(_properties2);}var messageExpression = t.callExpression(t.memberExpression(t.arrayExpression(messageElements), //object
      t.identifier('join'), //property
      false //computed
      ), [t.stringLiteral(' ')]);var message = { messageExpression: messageExpression, prefix: t.stringLiteral(metadata.prefix), content: targetNode, hasStartMessage: t.booleanLiteral(metadata.hasStartMessage), isStartMessage: t.booleanLiteral(metadata.isStartMessage), indent: t.numericLiteral(metadata.indent), parentName: t.stringLiteral(metadata.parentName), filename: t.stringLiteral(metadata.filename), dirname: t.stringLiteral(metadata.dirname), basename: t.stringLiteral(metadata.basename), extname: t.stringLiteral(metadata.extname) };var replacement = t.expressionStatement(alias(message, metadata));replacement[$handled] = true;statement.replaceWith(replacement);} });if (path.node) {if (path.get('body').isBlockStatement()) {path.replaceWithMultiple(path.get('body').node.body);} else {path.replaceWith(path.get('body').node);}}}var wrapVmRunner = template("\nvar VM_RUNNER_RUN_ID = '';\n\nfunction generateUid(){\n    var u='',i=0; var four = 4;\n    var pattern = 'xxxxxxxx-xxxx-'+four+'xxx-yxxx-xxxxxxxxxxxx';\n    while(i++<36) {\n        var c=pattern[i-1],\n        r=Math.random()*16|0,v=c=='x'?r:(r&0x3|0x8);\n        u+=(c=='-'||c==four)?c:v.toString(16)\n    }\n    return u;\n} \n\nif( typeof(vm2Options)==='undefined' ){\n  vm2Options = {};\n}\nvar VM_RUNNER_HASH = vm2Options.VM_RUNNER_HASH;\nvar customOptions = vm2Options.customOptions || {};\nvar traceOptions = customOptions.trace||{};\nvar vm2Expression = vm2Options.expression || null;\n\nvar VM_RUNNER_TRACE = function(logLevel,prefix,message,data){\n    var alias = traceOptions && traceOptions.aliases && traceOptions.aliases[logLevel] ;\n    var messageObj = {\n        frame:vmCodeFrame(vm2Expression,this.line),\n        prefix:prefix,\n        message:message,\n        logLevel:logLevel,\n        data:data,\n        line:this.line,\n        date:new Date()\n    }\n    if( alias ){\n        try{\n            return alias.apply(this,[messageObj]);\n        }catch(e){\n            console.error(e);\n        }\n    }\n};\n\n\n\nreturn (function vmRunnerWrapper() {\n    VM_RUNNER_RUN_ID = generateUid();\n    \n    BODY;\n}).apply(this);\n");
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9iYWJlbC1wbHVnaW4uanMiXSwibmFtZXMiOlsiZ2V0TG9nRnVuY3Rpb24iLCJoYW5kbGVMYWJlbGVkU3RhdGVtZW50IiwiYmFiZWwiLCJ2aXNpdG9yIiwiUHJvZ3JhbSIsInByb2dyYW0iLCJvcHRzIiwidHJhdmVyc2UiLCJMYWJlbGVkU3RhdGVtZW50IiwicGF0aCIsInZtUnVubmVyV3JhcHBlciIsIndyYXBwZWQiLCJ3cmFwVm1SdW5uZXIiLCJCT0RZIiwibm9kZSIsImJvZHkiLCJWTV9SVU5ORVJfUlVOX0lEIiwidHlwZXMiLCJpZGVudGlmaWVyIiwiVk1fUlVOTkVSX0hBU0giLCJWTV9SVU5ORVJfVFJBQ0UiLCJyZXBsYWNlV2l0aCIsImRpcmVjdGl2ZXMiLCJmc3BhdGgiLCJfIiwidGVtcGxhdGUiLCJnZXQiLCIkaGFuZGxlZCIsIlN5bWJvbCIsIiRub3JtYWxpemVkIiwiUFJFU0VSVkVfQ09OVEVYVFMiLCJub3JtYWxpemVFbnYiLCJwcm9jZXNzIiwiZW52IiwiVFJBQ0VfQ09OVEVYVCIsIlBSRVNFUlZFX0ZJTEVTIiwiVFJBQ0VfRklMRSIsIlBSRVNFUlZFX0xFVkVMUyIsIlRSQUNFX0xFVkVMIiwiaW5wdXQiLCJzcGxpdCIsIm1hcCIsImNvbnRleHQiLCJ0b0xvd2VyQ2FzZSIsInRyaW0iLCJmaWx0ZXIiLCJpZCIsImV4cHJlc3Npb24iLCJmbiIsImlkcyIsImxvZ0xldmVsIiwidCIsImxvZyIsIm1lc3NhZ2UiLCJtZXRhZGF0YSIsIm1lc3NhZ2VFeHByZXNzaW9uIiwicHJlZml4IiwiaW5kZW50IiwiQXJyYXkiLCJqb2luIiwiaXNTZXF1ZW5jZUV4cHJlc3Npb24iLCJjb250ZW50IiwiY2FsbEV4cHJlc3Npb24iLCJtZW1iZXJFeHByZXNzaW9uIiwic3RyaW5nTGl0ZXJhbCIsImNvbmNhdCIsImV4cHJlc3Npb25zIiwiTElORSIsImxvYyIsInN0YXJ0IiwibGluZSIsIkxPR0xFVkVMIiwiUFJFRklYIiwiREFUQSIsIm51bWVyaWNMaXRlcmFsIiwiTUVTU0FHRSIsImdlbmVyYXRlUHJlZml4IiwiZGlybmFtZSIsImJhc2VuYW1lIiwiY29sbGVjdE1ldGFkYXRhIiwiZmlsZW5hbWUiLCJyZXNvbHZlIiwiY3dkIiwiaHViIiwiZmlsZSIsImV4dG5hbWUiLCJuYW1lcyIsInBhcmVudCIsInBhcmVudE5hbWUiLCJnZXRBbmNlc3RyeSIsInNsaWNlIiwicmVkdWNlIiwicGFydHMiLCJpdGVtIiwiaXNDbGFzc01ldGhvZCIsInVuc2hpZnQiLCJrZXkiLCJ0eXBlIiwibmFtZSIsImlzQ2xhc3NEZWNsYXJhdGlvbiIsImlzRnVuY3Rpb24iLCJpc1Byb2dyYW0iLCJpc0NsYXNzQm9keSIsImlzQmxvY2tTdGF0ZW1lbnQiLCJoYXNTdGFydE1lc3NhZ2UiLCJpc1N0YXJ0TWVzc2FnZSIsImNoaWxkIiwiaXNMYWJlbGVkU3RhdGVtZW50IiwibGFiZWwiLCJhbGlhc2VzIiwic2hvdWxkU3RyaXAiLCJzdHJpcCIsInNlIiwiTk9ERV9FTlYiLCJsZW5ndGgiLCJzb21lIiwicGMiLCJpbmNsdWRlcyIsInBmIiwibGV2ZWwiLCJwbCIsIm5vcm1hbGl6ZU9wdHMiLCJ0cmFjZSIsIndhcm4iLCJlcnJvciIsImRlYnVnIiwiT2JqZWN0Iiwia2V5cyIsImZvckVhY2giLCJleHByIiwidW5kZWZpbmVkIiwicHJvZHVjdGlvbiIsImxhYmVsTmFtZSIsInZhcmlhYmxlcyIsIm1ldGhvZFBhdGgiLCJpbmRleE9mIiwicHVzaCIsImVhY2giLCJzY29wZSIsImJpbmRpbmdzIiwidmFsIiwiYWxpYXMiLCJyZW1vdmUiLCJlbXB0eVN0YXRlbWVudCIsInByb3BlcnRpZXMiLCJ2YXJOYW1lIiwiSWRlbnRpZmllciIsInZhbHVlIiwidGhpc0V4cHJlc3Npb24iLCJvYmplY3RQcm9wZXJ0eSIsInJlcGxhY2VtZW50Iiwib2JqZWN0RXhwcmVzc2lvbiIsImJ1aWxkQ29kZUZyYW1lRXJyb3IiLCJFeHByZXNzaW9uU3RhdGVtZW50Iiwic3RhdGVtZW50IiwidGFyZ2V0Tm9kZSIsIm1lc3NhZ2VFbGVtZW50cyIsImNoYWluIiwiZXhwcmVzc2lvbk5vZGUiLCJjb21wYWN0IiwiaXNFbXB0eSIsImFycmF5RXhwcmVzc2lvbiIsImJvb2xlYW5MaXRlcmFsIiwiZXhwcmVzc2lvblN0YXRlbWVudCIsInJlcGxhY2VXaXRoTXVsdGlwbGUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBc0NnQkEsYyxHQUFBQSxjOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQTRJQUMsc0IsR0FBQUEsc0I7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBNk5ELFVBQVVDLEtBQVYsRUFBaUI7QUFDNUIsU0FBTztBQUNIQyxJQUFBQSxPQUFPLEVBQUU7QUFDTEMsTUFBQUEsT0FESyxtQkFDSUMsT0FESixTQUNxQixLQUFQQyxJQUFPLFNBQVBBLElBQU87QUFDdEJELFFBQUFBLE9BQU8sQ0FBQ0UsUUFBUixDQUFrQjtBQUNkQyxVQUFBQSxnQkFEYyw0QkFDSUMsSUFESixFQUNVO0FBQ3BCUixZQUFBQSxzQkFBc0IsQ0FBRUMsS0FBRixFQUFTTyxJQUFULEVBQWVILElBQWYsQ0FBdEI7QUFDSCxXQUhhLEVBQWxCOzs7QUFNQSxZQUFJLENBQUNELE9BQU8sQ0FBQ0ssZUFBYixFQUE4QjtBQUMxQkwsVUFBQUEsT0FBTyxDQUFDSyxlQUFSLEdBQTBCLElBQTFCO0FBQ0EsY0FBSUMsT0FBTyxHQUFHQyxZQUFZLENBQUU7QUFDeEJDLFlBQUFBLElBQUksRUFBRVIsT0FBTyxDQUFDUyxJQUFSLENBQWFDLElBREs7QUFFeEJDLFlBQUFBLGdCQUFnQixFQUFDZCxLQUFLLENBQUNlLEtBQU4sQ0FBWUMsVUFBWixDQUF3QixrQkFBeEIsQ0FGTztBQUd4QkMsWUFBQUEsY0FBYyxFQUFDakIsS0FBSyxDQUFDZSxLQUFOLENBQVlDLFVBQVosQ0FBd0IsZ0JBQXhCLENBSFM7QUFJeEJFLFlBQUFBLGVBQWUsRUFBQ2xCLEtBQUssQ0FBQ2UsS0FBTixDQUFZQyxVQUFaLENBQXdCLGlCQUF4QixDQUpRLEVBQUYsQ0FBMUI7OztBQU9BYixVQUFBQSxPQUFPLENBQUNnQixXQUFSO0FBQ0luQixVQUFBQSxLQUFLLENBQUNlLEtBQU4sQ0FBWVosT0FBWixDQUFxQk0sT0FBckIsQ0FESjs7QUFHSDtBQUNETixRQUFBQSxPQUFPLENBQUNTLElBQVIsQ0FBYVEsVUFBYixHQUEwQixFQUExQjs7QUFFSCxPQXZCSSxFQUROLEVBQVA7OztBQTJCSCxDLENBM2FELDRCLElBQU9DLE0sNkRBQ1Asd0MsSUFBT0MsQyxtRUFDUCwyQyxJQUFPQyxRLGlFQUNQLGdDLElBQVFDLEcsV0FBQUEsRyxDQUVSLElBQU1DLFFBQVEsR0FBR0MsTUFBTSxDQUFFLFNBQUYsQ0FBdkIsQ0FDQSxJQUFNQyxXQUFXLEdBQUdELE1BQU0sQ0FBRSxZQUFGLENBQTFCLENBRUEsSUFBTUUsaUJBQWlCLEdBQUdDLFlBQVksQ0FBRUMsT0FBTyxDQUFDQyxHQUFSLENBQVlDLGFBQWQsQ0FBdEMsQ0FDQSxJQUFNQyxjQUFjLEdBQUdKLFlBQVksQ0FBRUMsT0FBTyxDQUFDQyxHQUFSLENBQVlHLFVBQWQsQ0FBbkMsQ0FDQSxJQUFNQyxlQUFlLEdBQUdOLFlBQVksQ0FBRUMsT0FBTyxDQUFDQyxHQUFSLENBQVlLLFdBQWQsQ0FBcEMsQyxDQUVBOztxb0JBR0EsU0FBU1AsWUFBVCxDQUF1QlEsS0FBdkIsRUFBNkIsQ0FDekIsSUFBSSxDQUFDQSxLQUFMLEVBQVksQ0FDUixPQUFPLEVBQVAsQ0FDSCxDQUNELE9BQU9BLEtBQUssQ0FBQ0MsS0FBTixDQUFhLEdBQWIsRUFDTkMsR0FETSxDQUNELFVBQUFDLE9BQU8sVUFBSUEsT0FBTyxDQUFDQyxXQUFSLEdBQXVCQyxJQUF2QixFQUFKLEVBRE4sRUFFTkMsTUFGTSxDQUVFLFVBQUFDLEVBQUUsVUFBSUEsRUFBSixFQUZKLENBQVAsQ0FHSCxDLENBRUQ7OzB6QkFHQSxTQUFTQyxVQUFULENBQXFCUixLQUFyQixFQUE0QmQsUUFBNUIsRUFBc0MsQ0FDbEMsSUFBTXVCLEVBQUUsR0FBR3ZCLFFBQVEsQ0FBRWMsS0FBRixDQUFuQixDQUNBLE9BQU8sVUFBVVUsR0FBVixFQUFlLENBQ2xCLElBQU1uQyxJQUFJLEdBQUdrQyxFQUFFLENBQUVDLEdBQUYsQ0FBZixDQUNBLE9BQU9uQyxJQUFJLENBQUNpQyxVQUFMLEdBQWtCakMsSUFBSSxDQUFDaUMsVUFBdkIsR0FBb0NqQyxJQUEzQyxDQUNILENBSEQsQ0FJSCxDLENBRUQ7OzA5QkFHTyxTQUFTZCxjQUFULE9BQStDa0QsUUFBL0MsRUFBeUQsS0FBeEJDLENBQXdCLFFBQS9CbEMsS0FBK0IsQ0FBckJRLFFBQXFCLFFBQXJCQSxRQUFxQixDQUM1RCxPQUFPLFNBQVMyQixHQUFULENBQWNDLE9BQWQsRUFBdUJDLFFBQXZCLEVBQWlDLENBQ3BDLElBQUlDLGlCQUFpQixHQUFHRixPQUFPLENBQUNFLGlCQUFoQyxDQUNBLElBQUlDLE1BQU0sYUFBTUYsUUFBUSxDQUFDWixPQUFmLE1BQVYsQ0FDQSxJQUFJWSxRQUFRLENBQUNHLE1BQWIsRUFBcUIsQ0FDakJELE1BQU0sSUFBSyxJQUFJRSxLQUFKLENBQVdKLFFBQVEsQ0FBQ0csTUFBVCxHQUFrQixDQUE3QixDQUFELENBQWtDRSxJQUFsQyxDQUF3QyxJQUF4QyxDQUFWLENBQ0gsQ0FHRCxJQUFJUixDQUFDLENBQUNTLG9CQUFGLENBQXdCUCxPQUFPLENBQUNRLE9BQWhDLENBQUosRUFBOEMsQ0FDMUMsT0FBT1YsQ0FBQyxDQUFDVyxjQUFGLENBQ0hYLENBQUMsQ0FBQ1ksZ0JBQUYsQ0FDSVosQ0FBQyxDQUFDakMsVUFBRixDQUFjLFNBQWQsQ0FESixFQUVJaUMsQ0FBQyxDQUFDakMsVUFBRixDQUFjZ0MsUUFBZCxDQUZKLENBREcsRUFLSCxDQUFDQyxDQUFDLENBQUNhLGFBQUYsQ0FBaUJSLE1BQWpCLENBQUQsRUFBMkJTLE1BQTNCLENBQW1DWixPQUFPLENBQUNRLE9BQVIsQ0FBZ0JLLFdBQW5ELENBTEcsQ0FBUCxDQU9ILENBUkQsTUFRTyxDQUNILElBQU1DLElBQUksR0FBR2IsUUFBUSxDQUFDN0MsSUFBVCxDQUFjSyxJQUFkLENBQW1Cc0QsR0FBbkIsQ0FBdUJDLEtBQXZCLENBQTZCQyxJQUExQyxDQUNBLE9BQU92QixVQUFVLDBFQUEyRXRCLFFBQTNFLENBQVYsQ0FBZ0csRUFDbkc4QyxRQUFRLEVBQUVwQixDQUFDLENBQUNhLGFBQUYsQ0FBaUJkLFFBQWpCLENBRHlGLEVBRW5Hc0IsTUFBTSxFQUFFckIsQ0FBQyxDQUFDYSxhQUFGLENBQWlCUixNQUFqQixDQUYyRixFQUduR2lCLElBQUksRUFBRXBCLE9BQU8sQ0FBQ1EsT0FIcUYsRUFJbkdNLElBQUksRUFBQ2hCLENBQUMsQ0FBQ3VCLGNBQUYsQ0FBaUJQLElBQWpCLENBSjhGLEVBS25HL0MsZUFBZSxFQUFDK0IsQ0FBQyxDQUFDakMsVUFBRixDQUFjLGlCQUFkLENBTG1GLEVBTW5HeUQsT0FBTyxFQUFDcEIsaUJBTjJGLEVBQWhHLENBQVAsQ0FRSCxDQUNKLENBM0JELENBNEJILENBRUQsU0FBU3FCLGNBQVQsQ0FBeUJDLE9BQXpCLEVBQWtDQyxRQUFsQyxFQUE0QyxDQUN4QyxJQUFJQSxRQUFRLEtBQUssT0FBakIsRUFBMEIsQ0FDdEIsT0FBT0EsUUFBUCxDQUNILENBQ0RBLFFBQVEsR0FBR3ZELE1BQU0sQ0FBQ3VELFFBQVAsQ0FBaUJELE9BQWpCLENBQVgsQ0FDQSxJQUFJQyxRQUFRLEtBQUssS0FBYixJQUFzQkEsUUFBUSxLQUFLLEtBQXZDLEVBQThDLENBQzFDLE9BQU9BLFFBQVAsQ0FDSCxDQUNELE9BQU92RCxNQUFNLENBQUN1RCxRQUFQLENBQWlCdkQsTUFBTSxDQUFDc0QsT0FBUCxDQUFnQkEsT0FBaEIsQ0FBakIsQ0FBUCxDQUNILEMsQ0FFRDs7O3dpRUFJQSxTQUFTRSxlQUFULENBQTBCdEUsSUFBMUIsRUFBZ0NILElBQWhDLEVBQXNDLENBQ2xDLElBQU0wRSxRQUFRLEdBQUd6RCxNQUFNLENBQUMwRCxPQUFQLENBQWdCakQsT0FBTyxDQUFDa0QsR0FBUixFQUFoQixFQUFnQ3pFLElBQUksQ0FBQzBFLEdBQUwsQ0FBU0MsSUFBVCxDQUFjOUUsSUFBZCxDQUFtQjBFLFFBQW5ELENBQWpCLENBQ0EsSUFBTUgsT0FBTyxHQUFHdEQsTUFBTSxDQUFDc0QsT0FBUCxDQUFnQkcsUUFBaEIsQ0FBaEIsQ0FDQSxJQUFNSyxPQUFPLEdBQUc5RCxNQUFNLENBQUM4RCxPQUFQLENBQWdCTCxRQUFoQixDQUFoQixDQUNBLElBQU1GLFFBQVEsR0FBR3ZELE1BQU0sQ0FBQ3VELFFBQVAsQ0FBaUJFLFFBQWpCLEVBQTJCSyxPQUEzQixDQUFqQixDQUNBLElBQU03QixNQUFNLEdBQUdvQixjQUFjLENBQUVDLE9BQUYsRUFBV0MsUUFBWCxDQUE3QixDQUNBLElBQU1RLEtBQUssR0FBRyxFQUFkLENBQ0EsSUFBSTdCLE1BQU0sR0FBRyxDQUFiLENBQ0EsSUFBSThCLE1BQUosQ0FFQSxJQUFNQyxVQUFVLEdBQUcvRSxJQUFJLENBQUNnRixXQUFMLEdBQW9CQyxLQUFwQixDQUEyQixDQUEzQixFQUE4QkMsTUFBOUIsQ0FBc0MsVUFBQ0MsS0FBRCxFQUFRQyxJQUFSLEVBQWlCLENBQ3RFLElBQUlBLElBQUksQ0FBQ0MsYUFBTCxFQUFKLEVBQTJCLENBQ3ZCLElBQUksQ0FBQ1AsTUFBTCxFQUFhLENBQ1RBLE1BQU0sR0FBR00sSUFBVCxDQUNILENBQ0RELEtBQUssQ0FBQ0csT0FBTixDQUFlRixJQUFJLENBQUMvRSxJQUFMLENBQVVrRixHQUFWLENBQWNDLElBQWQsS0FBdUIsWUFBdkIsR0FBc0NKLElBQUksQ0FBQy9FLElBQUwsQ0FBVWtGLEdBQVYsQ0FBY0UsSUFBcEQsR0FBMkQsbUJBQTFFLEVBQ0gsQ0FMRCxNQUtPLElBQUlMLElBQUksQ0FBQ00sa0JBQUwsRUFBSixFQUFnQyxDQUNuQyxJQUFJLENBQUNaLE1BQUwsRUFBYSxDQUNUQSxNQUFNLEdBQUdNLElBQVQsQ0FDSCxDQUNERCxLQUFLLENBQUNHLE9BQU4sQ0FBZUYsSUFBSSxDQUFDL0UsSUFBTCxDQUFVZ0MsRUFBVixHQUFlK0MsSUFBSSxDQUFDL0UsSUFBTCxDQUFVZ0MsRUFBVixDQUFhb0QsSUFBNUIsOEJBQXVETCxJQUFJLENBQUMvRSxJQUFMLENBQVVzRCxHQUFWLENBQWNDLEtBQWQsQ0FBb0JDLElBQTNFLE1BQWYsRUFDSCxDQUxNLE1BS0EsSUFBSXVCLElBQUksQ0FBQ08sVUFBTCxFQUFKLEVBQXdCLENBQzNCLElBQUksQ0FBQ2IsTUFBTCxFQUFhLENBQ1RBLE1BQU0sR0FBR00sSUFBVCxDQUNILENBQ0RELEtBQUssQ0FBQ0csT0FBTixDQUFnQkYsSUFBSSxDQUFDL0UsSUFBTCxDQUFVZ0MsRUFBVixJQUFnQitDLElBQUksQ0FBQy9FLElBQUwsQ0FBVWdDLEVBQVYsQ0FBYW9ELElBQTlCLHlCQUFxREwsSUFBSSxDQUFDL0UsSUFBTCxDQUFVc0QsR0FBVixDQUFjQyxLQUFkLENBQW9CQyxJQUF6RSxNQUFmLEVBQ0gsQ0FMTSxNQUtBLElBQUl1QixJQUFJLENBQUNRLFNBQUwsRUFBSixFQUF1QixDQUMxQixJQUFJLENBQUNkLE1BQUwsRUFBYSxDQUNUQSxNQUFNLEdBQUdNLElBQVQsQ0FDSCxDQUNKLENBSk0sTUFJQSxJQUFJLENBQUNOLE1BQUQsSUFBVyxDQUFDTSxJQUFJLENBQUNTLFdBQUwsRUFBWixJQUFtQyxDQUFDVCxJQUFJLENBQUNVLGdCQUFMLEVBQXhDLEVBQWtFLENBQ3JFOUMsTUFBTSxHQUNULENBQ0QsT0FBT21DLEtBQVAsQ0FDSCxDQXhCa0IsRUF3QmhCLEVBeEJnQixFQXdCWmpDLElBeEJZLENBd0JOLEdBeEJNLENBQW5CLENBMEJBLElBQUk2QyxlQUFlLEdBQUcsS0FBdEIsQ0FDQSxJQUFJQyxjQUFjLEdBQUcsS0FBckIsQ0FDQSxJQUFJbEIsTUFBTSxJQUFJLENBQUNBLE1BQU0sQ0FBQ2MsU0FBUCxFQUFmLEVBQW9DLHdHQUNoQyxxQkFBa0JkLE1BQU0sQ0FBQzdELEdBQVAsQ0FBWSxNQUFaLEVBQW9CQSxHQUFwQixDQUF5QixNQUF6QixDQUFsQiw4SEFBb0QsS0FBM0NnRixLQUEyQyxlQUNoRCxJQUFJQSxLQUFLLENBQUM1RixJQUFOLENBQVdhLFFBQVgsQ0FBSixFQUEwQixDQUN0QjZFLGVBQWUsR0FBRyxJQUFsQixDQUNBLE1BQ0gsQ0FDRCxJQUFJLENBQUNFLEtBQUssQ0FBQ0Msa0JBQU4sRUFBTCxFQUFrQyxDQUM5QixNQUNILENBQ0QsSUFBTUMsS0FBSyxHQUFHRixLQUFLLENBQUNoRixHQUFOLENBQVcsT0FBWCxDQUFkLENBQ0EsSUFBSXBCLElBQUksQ0FBQ3VHLE9BQUwsQ0FBYUQsS0FBSyxDQUFDOUYsSUFBTixDQUFXb0YsSUFBeEIsQ0FBSixFQUFtQyxDQUMvQk0sZUFBZSxHQUFHLElBQWxCLENBQ0EsSUFBSUUsS0FBSyxDQUFDNUYsSUFBTixLQUFlTCxJQUFJLENBQUNLLElBQXhCLEVBQThCLENBQzFCMkYsY0FBYyxHQUFHLElBQWpCLENBQ0gsQ0FDRCxNQUNILENBQ0osQ0FqQitCLCtOQWtCbkMsQ0FFRCxJQUFNL0QsT0FBTyxhQUFNYyxNQUFOLGNBQWdCZ0MsVUFBaEIsQ0FBYixDQUNBLE9BQU8sRUFBQy9CLE1BQU0sRUFBTkEsTUFBRCxFQUFTRCxNQUFNLEVBQU5BLE1BQVQsRUFBaUJnQyxVQUFVLEVBQVZBLFVBQWpCLEVBQTZCOUMsT0FBTyxFQUFQQSxPQUE3QixFQUFzQzhELGVBQWUsRUFBZkEsZUFBdEMsRUFBdURDLGNBQWMsRUFBZEEsY0FBdkQsRUFBdUV6QixRQUFRLEVBQVJBLFFBQXZFLEVBQWlGSCxPQUFPLEVBQVBBLE9BQWpGLEVBQTBGQyxRQUFRLEVBQVJBLFFBQTFGLEVBQW9HTyxPQUFPLEVBQVBBLE9BQXBHLEVBQTZHNUUsSUFBSSxFQUFKQSxJQUE3RyxFQUFQLENBQ0gsQyxDQUVEOztrdUlBR0EsU0FBU3FHLFdBQVQsQ0FBc0JaLElBQXRCLEVBQTRCNUMsUUFBNUIsU0FBK0MsS0FBUnlELEtBQVEsU0FBUkEsS0FBUSxDQUMzQyxnQkFBZUEsS0FBZixJQUNJLEtBQUssU0FBTCxDQUNJLElBQUksQ0FBQ0EsS0FBTCxFQUFZLE9BQU8sS0FBUCxDQURoQixDQUVJO0FBQ0EsWUFDSixLQUFLLFFBQUwsQ0FDSSxJQUFNQyxFQUFFLEdBQUdELEtBQUssQ0FBQ2IsSUFBRCxDQUFoQixDQUNBLElBQUksQ0FBQ2MsRUFBRCxJQUFRLFFBQU9BLEVBQVAsTUFBYyxRQUFkLElBQTBCLENBQUNBLEVBQUUsQ0FBQ2hGLE9BQU8sQ0FBQ0MsR0FBUixDQUFZZ0YsUUFBYixDQUF6QyxFQUFrRSxPQUFPLEtBQVAsQ0FGdEUsQ0FHSTtBQUNBLFlBQ0osUUFDSSxPQUFPLEtBQVAsQ0FYUixDQWFBLElBQUluRixpQkFBaUIsQ0FBQ29GLE1BQXRCLEVBQThCLENBQzFCLElBQU14RSxPQUFPLEdBQUdZLFFBQVEsQ0FBQ1osT0FBVCxDQUFpQkMsV0FBakIsRUFBaEIsQ0FDQSxJQUFJYixpQkFBaUIsQ0FBQ3FGLElBQWxCLENBQXdCLFVBQUFDLEVBQUUsVUFBSTFFLE9BQU8sQ0FBQzJFLFFBQVIsQ0FBa0JELEVBQWxCLENBQUosRUFBMUIsQ0FBSixFQUEwRCxPQUFPLEtBQVAsQ0FDN0QsQ0FDRCxJQUFJakYsY0FBYyxDQUFDK0UsTUFBbkIsRUFBMkIsQ0FDdkIsSUFBTWxDLFFBQVEsR0FBRzFCLFFBQVEsQ0FBQzBCLFFBQVQsQ0FBa0JyQyxXQUFsQixFQUFqQixDQUNBLElBQUlSLGNBQWMsQ0FBQ2dGLElBQWYsQ0FBcUIsVUFBQUcsRUFBRSxVQUFJdEMsUUFBUSxDQUFDcUMsUUFBVCxDQUFtQkMsRUFBbkIsQ0FBSixFQUF2QixDQUFKLEVBQXdELE9BQU8sS0FBUCxDQUMzRCxDQUNELElBQUlqRixlQUFlLENBQUM2RSxNQUFwQixFQUE0QixDQUN4QixJQUFNSyxLQUFLLEdBQUdyQixJQUFJLENBQUN2RCxXQUFMLEVBQWQsQ0FDQSxJQUFJTixlQUFlLENBQUM4RSxJQUFoQixDQUFzQixVQUFBSyxFQUFFLFVBQUlELEtBQUssS0FBS0MsRUFBZCxFQUF4QixDQUFKLEVBQStDLE9BQU8sS0FBUCxDQUNsRCxDQUNELE9BQU8sSUFBUCxDQUNILENBRU0sU0FBU3ZILHNCQUFULENBQWlDQyxLQUFqQyxFQUF3Q08sSUFBeEMsRUFBOENILElBQTlDLEVBQW9ELENBQ3ZELElBQU02QyxDQUFDLEdBQUdqRCxLQUFLLENBQUNlLEtBQWhCLENBQ0EsSUFBTTJGLEtBQUssR0FBR25HLElBQUksQ0FBQ2lCLEdBQUwsQ0FBVSxPQUFWLENBQWQsQ0FDQXBCLElBQUksR0FBSSxTQUFTbUgsYUFBVCxDQUF3QnZILEtBQXhCLEVBQStCSSxJQUEvQixFQUFxQyxDQUN6QyxJQUFJQSxJQUFJLENBQUN1QixXQUFELENBQVIsRUFBdUIsQ0FDbkIsT0FBT3ZCLElBQVAsQ0FDSCxDQUNELElBQUksQ0FBQ0EsSUFBSSxDQUFDdUcsT0FBVixFQUFtQixDQUNmdkcsSUFBSSxDQUFDdUcsT0FBTCxHQUFlLEVBQ1h6RCxHQUFHLEVBQUVwRCxjQUFjLENBQUVFLEtBQUYsRUFBUyxLQUFULENBRFIsRUFFWHdILEtBQUssRUFBRTFILGNBQWMsQ0FBRUUsS0FBRixFQUFTLE9BQVQsQ0FGVixFQUdYeUgsSUFBSSxFQUFFM0gsY0FBYyxDQUFFRSxLQUFGLEVBQVMsTUFBVCxDQUhULEVBSVgwSCxLQUFLLEVBQUM1SCxjQUFjLENBQUNFLEtBQUQsRUFBTyxPQUFQLENBSlQsRUFLWDJILEtBQUssRUFBQzdILGNBQWMsQ0FBQ0UsS0FBRCxFQUFPLE9BQVAsQ0FMVCxFQUFmLENBT0gsQ0FSRCxNQVFPLENBQ0g0SCxNQUFNLENBQUNDLElBQVAsQ0FBYXpILElBQUksQ0FBQ3VHLE9BQWxCLEVBQTJCbUIsT0FBM0IsQ0FBb0MsVUFBQWhDLEdBQUcsRUFBSSxDQUN2QyxJQUFJLE9BQU8xRixJQUFJLENBQUN1RyxPQUFMLENBQWFiLEdBQWIsQ0FBUCxLQUE2QixRQUE3QixJQUF5QzFGLElBQUksQ0FBQ3VHLE9BQUwsQ0FBYWIsR0FBYixDQUE3QyxFQUFnRSxDQUM1RCxJQUFNaUMsSUFBSSxHQUFHbEYsVUFBVSxDQUFFekMsSUFBSSxDQUFDdUcsT0FBTCxDQUFhYixHQUFiLENBQUYsRUFBcUI5RixLQUFLLENBQUN1QixRQUEzQixDQUF2QixDQUNBbkIsSUFBSSxDQUFDdUcsT0FBTCxDQUFhYixHQUFiLElBQW9CLFVBQUMzQyxPQUFELFVBQWE0RSxJQUFJLENBQUU1RSxPQUFGLENBQWpCLEVBQXBCLENBQ0gsQ0FDSixDQUxELEVBTUgsQ0FDRCxJQUFJL0MsSUFBSSxDQUFDeUcsS0FBTCxLQUFlbUIsU0FBbkIsRUFBOEIsQ0FDMUI1SCxJQUFJLENBQUN5RyxLQUFMLEdBQWEsRUFDVDNELEdBQUcsRUFBRSxFQUFDK0UsVUFBVSxFQUFFLElBQWIsRUFESSxFQUVUVCxLQUFLLEVBQUUsS0FGRSxFQUdUQyxJQUFJLEVBQUUsRUFBQ1EsVUFBVSxFQUFFLElBQWIsRUFIRyxFQUFiLENBS0gsQ0FDRDdILElBQUksQ0FBQ3VCLFdBQUQsQ0FBSixHQUFvQixJQUFwQixDQUNBLE9BQU92QixJQUFQLENBQ0gsQ0E3Qk0sQ0E2QkpKLEtBN0JJLEVBNkJHSSxJQTdCSCxDQUFQLENBK0JBLElBQU04SCxTQUFTLEdBQUd4QixLQUFLLENBQUM5RixJQUFOLENBQVdvRixJQUE3QixDQUNBLElBQU1tQyxTQUFTLEdBQUksRUFBbkIsQ0FFQSxJQUFNQyxVQUFVLEdBQUc1RyxHQUFHLENBQUNqQixJQUFELEVBQU0sdUJBQU4sRUFBOEIsSUFBOUIsQ0FBdEIsQ0FDQSxJQUFHNkgsVUFBVSxJQUFHLENBQUMsYUFBRCxFQUFlLGNBQWYsRUFBK0JDLE9BQS9CLENBQXVDRCxVQUFVLENBQUNyQyxJQUFsRCxJQUF3RCxDQUFDLENBQXRFLElBQXlFLENBQUNxQyxVQUFVLENBQUN4SCxJQUFYLFVBQTdFLEVBQW9HLENBQ2hHdUgsU0FBUyxDQUFDRyxJQUFWLENBQWUsTUFBZixFQUNILENBQ0RoSCxDQUFDLENBQUNpSCxJQUFGLENBQVFoSSxJQUFJLENBQUNpSSxLQUFMLENBQVdDLFFBQW5CLEVBQThCLFVBQUNDLEdBQUQsRUFBSzVDLEdBQUwsRUFBVyxDQUNyQyxJQUFHcUMsU0FBUyxDQUFDRSxPQUFWLENBQWtCdkMsR0FBbEIsS0FBd0IsQ0FBQyxDQUE1QixFQUNJcUMsU0FBUyxDQUFDRyxJQUFWLENBQWV4QyxHQUFmLEVBQ1AsQ0FIRCxFQU1BLElBQU02QyxLQUFLLEdBQUd2SSxJQUFJLENBQUN1RyxPQUFMLENBQWF1QixTQUFiLENBQWQsQ0FDQSxJQUFJLENBQUNTLEtBQUwsRUFBWSxDQUNSLE9BQ0gsQ0FDRCxJQUFNdkYsUUFBUSxHQUFHeUIsZUFBZSxDQUFFdEUsSUFBRixFQUFRSCxJQUFSLENBQWhDLENBQ0EsSUFBSXdHLFdBQVcsQ0FBRUYsS0FBSyxDQUFDOUYsSUFBTixDQUFXb0YsSUFBYixFQUFtQjVDLFFBQW5CLEVBQTZCaEQsSUFBN0IsQ0FBZixFQUFtRCxDQUMvQ0csSUFBSSxDQUFDcUksTUFBTCxHQUNBLE9BQ0gsQ0FFRHJJLElBQUksQ0FBQ0YsUUFBTCxDQUFlLEVBQ1gsZ0JBRFcsMEJBQ093SSxjQURQLEVBQ3NCLENBQzdCLElBQUlDLFVBQVUsR0FBR3hILENBQUMsQ0FBQ2lCLEdBQUYsQ0FBTzRGLFNBQVAsRUFBa0IsVUFBQ1ksT0FBRCxFQUFhLENBQzVDLElBQUlqRCxHQUFHLEdBQUc3QyxDQUFDLENBQUMrRixVQUFGLENBQWNELE9BQWQsQ0FBVixDQUNBLElBQUlFLEtBQUosQ0FDQSxJQUFHRixPQUFPLElBQUUsTUFBWixFQUFvQixDQUNoQkUsS0FBSyxHQUFHaEcsQ0FBQyxDQUFDK0YsVUFBRixDQUFjRCxPQUFkLENBQVIsQ0FDSCxDQUZELE1BRUssQ0FDREUsS0FBSyxHQUFHaEcsQ0FBQyxDQUFDaUcsY0FBRixFQUFSLENBQ0gsQ0FDRCxPQUFPakcsQ0FBQyxDQUFDa0csY0FBRixDQUFrQnJELEdBQWxCLEVBQXVCbUQsS0FBdkIsRUFBOEIsS0FBOUIsQ0FBUCxDQUNILENBVGdCLENBQWpCLENBVUEsSUFBSUcsV0FBVyxHQUFHbkcsQ0FBQyxDQUFDb0csZ0JBQUYsQ0FBb0JQLFVBQXBCLENBQWxCLENBQ0FNLFdBQVcsQ0FBQzNILFFBQUQsQ0FBWCxHQUF3QixJQUF4QixDQUNBb0gsY0FBYyxDQUFDMUgsV0FBZixDQUE0QmlJLFdBQTVCLEVBQ0gsQ0FmVSxFQWdCWDtzdkVBR0Esb0dBbkJXLHlHQW1CMkZ6RCxJQW5CM0YsRUFtQmlHLENBQ3hHLE1BQU1wRixJQUFJLENBQUMrSSxtQkFBTCx3REFBMEUzRCxJQUFJLENBQUNJLElBQS9FLEVBQU4sQ0FDSCxDQXJCVSxFQXNCWHdELG1CQXRCVywrQkFzQlVDLFNBdEJWLEVBc0JxQixDQUM1QixJQUFJQSxTQUFTLENBQUM1SSxJQUFWLENBQWVhLFFBQWYsQ0FBSixFQUE4QixDQUMxQixPQUNILENBQ0QsSUFBSWdJLFVBQVUsR0FBR0QsU0FBUyxDQUFDaEksR0FBVixDQUFlLFlBQWYsRUFBNkJaLElBQTlDLENBQ0EsSUFBTThJLGVBQWUsR0FBRyxFQUF4QixDQUNBLElBQUdELFVBQVUsQ0FBQzFELElBQVgsS0FBa0Isb0JBQXJCLEVBQTBDLENBQ3RDLElBQUkrQyxVQUFVLEdBQUd4SCxDQUFDLENBQUNxSSxLQUFGLENBQVFGLFVBQVUsQ0FBQ3pGLFdBQW5CLEVBQWdDekIsR0FBaEMsQ0FBb0MsVUFBQ3FILGNBQUQsRUFBb0IsQ0FDckUsSUFBRyxDQUFDLFlBQUQsRUFBYyxnQkFBZCxFQUFnQ3ZCLE9BQWhDLENBQXdDdUIsY0FBYyxDQUFDN0QsSUFBdkQsSUFBNkQsQ0FBQyxDQUFqRSxFQUFtRSxDQUMvRCxJQUFJZ0QsT0FBTyxHQUFHYSxjQUFjLENBQUM3RCxJQUFmLEtBQXNCLFlBQXRCLEdBQW1DNkQsY0FBYyxDQUFDNUQsSUFBbEQsR0FBdUQsTUFBckUsQ0FDQSxJQUFJRixHQUFHLEdBQUc3QyxDQUFDLENBQUMrRixVQUFGLENBQWNELE9BQWQsQ0FBVixDQUNBLElBQUlFLEtBQUosQ0FDQSxJQUFHVyxjQUFjLENBQUM3RCxJQUFmLEtBQXNCLFlBQXpCLEVBQXVDLENBQ25Da0QsS0FBSyxHQUFHaEcsQ0FBQyxDQUFDK0YsVUFBRixDQUFjRCxPQUFkLENBQVIsQ0FDSCxDQUZELE1BRUssQ0FDREUsS0FBSyxHQUFHaEcsQ0FBQyxDQUFDaUcsY0FBRixFQUFSLENBQ0gsQ0FDRCxPQUFPakcsQ0FBQyxDQUFDa0csY0FBRixDQUFrQnJELEdBQWxCLEVBQXVCbUQsS0FBdkIsRUFBOEIsS0FBOUIsQ0FBUCxDQUNILENBVkQsTUFVTSxJQUFHLENBQUMsZUFBRCxFQUFpQixpQkFBakIsRUFBb0NaLE9BQXBDLENBQTRDdUIsY0FBYyxDQUFDN0QsSUFBM0QsSUFBaUUsQ0FBQyxDQUFyRSxFQUF1RSxDQUN6RTJELGVBQWUsQ0FBQ3BCLElBQWhCLENBQXFCc0IsY0FBckIsRUFDSCxDQUNKLENBZGdCLEVBY2RDLE9BZGMsR0FjSlosS0FkSSxFQUFqQixDQWVBLElBQUkzSCxDQUFDLENBQUN3SSxPQUFGLENBQVVoQixVQUFWLEtBQXlCLENBQUN4SCxDQUFDLENBQUN3SSxPQUFGLENBQVVKLGVBQVYsQ0FBOUIsRUFBMEQsQ0FDdEQsSUFBSVosV0FBVSxHQUFHeEgsQ0FBQyxDQUFDaUIsR0FBRixDQUFPNEYsU0FBUCxFQUFrQixVQUFDWSxPQUFELEVBQWEsQ0FDNUMsSUFBSWpELEdBQUcsR0FBRzdDLENBQUMsQ0FBQytGLFVBQUYsQ0FBY0QsT0FBZCxDQUFWLENBQ0EsSUFBSUUsS0FBSixDQUNBLElBQUdGLE9BQU8sSUFBRSxNQUFaLEVBQW9CLENBQ2hCRSxLQUFLLEdBQUdoRyxDQUFDLENBQUMrRixVQUFGLENBQWNELE9BQWQsQ0FBUixDQUNILENBRkQsTUFFSyxDQUNERSxLQUFLLEdBQUdoRyxDQUFDLENBQUNpRyxjQUFGLEVBQVIsQ0FDSCxDQUNELE9BQU9qRyxDQUFDLENBQUNrRyxjQUFGLENBQWtCckQsR0FBbEIsRUFBdUJtRCxLQUF2QixFQUE4QixLQUE5QixDQUFQLENBQ0gsQ0FUZ0IsQ0FBakIsQ0FVQVEsVUFBVSxHQUFHeEcsQ0FBQyxDQUFDb0csZ0JBQUYsQ0FBb0JQLFdBQXBCLENBQWIsQ0FDSCxDQVpELE1BY0lXLFVBQVUsR0FBR3hHLENBQUMsQ0FBQ29HLGdCQUFGLENBQW9CUCxVQUFwQixDQUFiLENBQ1AsQ0EvQkQsTUErQk0sSUFBRyxDQUFDLGlCQUFELEVBQW1CLGVBQW5CLEVBQW9DVCxPQUFwQyxDQUE0Q29CLFVBQVUsQ0FBQzFELElBQXZELElBQTZELENBQUMsQ0FBakUsRUFBbUUsQ0FDckUyRCxlQUFlLENBQUNwQixJQUFoQixDQUFxQm1CLFVBQXJCLEVBRUEsSUFBSVgsWUFBVSxHQUFHeEgsQ0FBQyxDQUFDaUIsR0FBRixDQUFPNEYsU0FBUCxFQUFrQixVQUFDWSxPQUFELEVBQWEsQ0FDNUMsSUFBSWpELEdBQUcsR0FBRzdDLENBQUMsQ0FBQytGLFVBQUYsQ0FBY0QsT0FBZCxDQUFWLENBQ0EsSUFBSUUsS0FBSixDQUNBLElBQUdGLE9BQU8sSUFBRSxNQUFaLEVBQW9CLENBQ2hCRSxLQUFLLEdBQUdoRyxDQUFDLENBQUMrRixVQUFGLENBQWNELE9BQWQsQ0FBUixDQUNILENBRkQsTUFFSyxDQUNERSxLQUFLLEdBQUdoRyxDQUFDLENBQUNpRyxjQUFGLEVBQVIsQ0FDSCxDQUNELE9BQU9qRyxDQUFDLENBQUNrRyxjQUFGLENBQWtCckQsR0FBbEIsRUFBdUJtRCxLQUF2QixFQUE4QixLQUE5QixDQUFQLENBQ0gsQ0FUZ0IsQ0FBakIsQ0FVQVEsVUFBVSxHQUFHeEcsQ0FBQyxDQUFDb0csZ0JBQUYsQ0FBb0JQLFlBQXBCLENBQWIsQ0FDSCxDQUdELElBQU16RixpQkFBaUIsR0FBR0osQ0FBQyxDQUFDVyxjQUFGLENBQ3RCWCxDQUFDLENBQUNZLGdCQUFGLENBQ0laLENBQUMsQ0FBQzhHLGVBQUYsQ0FBa0JMLGVBQWxCLENBREosRUFDdUM7QUFDbkN6RyxNQUFBQSxDQUFDLENBQUNqQyxVQUFGLENBQWEsTUFBYixDQUZKLEVBRXlCO0FBQ3JCLFdBSEosQ0FHUztBQUhULE9BRHNCLEVBTXBCLENBQ0VpQyxDQUFDLENBQUNhLGFBQUYsQ0FBZ0IsR0FBaEIsQ0FERixDQU5vQixDQUExQixDQVVBLElBQU1YLE9BQU8sR0FBRyxFQUNaRSxpQkFBaUIsRUFBakJBLGlCQURZLEVBRVpDLE1BQU0sRUFBRUwsQ0FBQyxDQUFDYSxhQUFGLENBQWlCVixRQUFRLENBQUNFLE1BQTFCLENBRkksRUFHWkssT0FBTyxFQUFFOEYsVUFIRyxFQUlabkQsZUFBZSxFQUFFckQsQ0FBQyxDQUFDK0csY0FBRixDQUFrQjVHLFFBQVEsQ0FBQ2tELGVBQTNCLENBSkwsRUFLWkMsY0FBYyxFQUFFdEQsQ0FBQyxDQUFDK0csY0FBRixDQUFrQjVHLFFBQVEsQ0FBQ21ELGNBQTNCLENBTEosRUFNWmhELE1BQU0sRUFBRU4sQ0FBQyxDQUFDdUIsY0FBRixDQUFrQnBCLFFBQVEsQ0FBQ0csTUFBM0IsQ0FOSSxFQU9aK0IsVUFBVSxFQUFFckMsQ0FBQyxDQUFDYSxhQUFGLENBQWlCVixRQUFRLENBQUNrQyxVQUExQixDQVBBLEVBUVpSLFFBQVEsRUFBRTdCLENBQUMsQ0FBQ2EsYUFBRixDQUFpQlYsUUFBUSxDQUFDMEIsUUFBMUIsQ0FSRSxFQVNaSCxPQUFPLEVBQUUxQixDQUFDLENBQUNhLGFBQUYsQ0FBaUJWLFFBQVEsQ0FBQ3VCLE9BQTFCLENBVEcsRUFVWkMsUUFBUSxFQUFFM0IsQ0FBQyxDQUFDYSxhQUFGLENBQWlCVixRQUFRLENBQUN3QixRQUExQixDQVZFLEVBV1pPLE9BQU8sRUFBRWxDLENBQUMsQ0FBQ2EsYUFBRixDQUFpQlYsUUFBUSxDQUFDK0IsT0FBMUIsQ0FYRyxFQUFoQixDQWFBLElBQU1pRSxXQUFXLEdBQUduRyxDQUFDLENBQUNnSCxtQkFBRixDQUF1QnRCLEtBQUssQ0FBRXhGLE9BQUYsRUFBV0MsUUFBWCxDQUE1QixDQUFwQixDQUNBZ0csV0FBVyxDQUFDM0gsUUFBRCxDQUFYLEdBQXdCLElBQXhCLENBQ0ErSCxTQUFTLENBQUNySSxXQUFWLENBQXVCaUksV0FBdkIsRUFDSCxDQXRHVSxFQUFmLEVBeUdBLElBQUk3SSxJQUFJLENBQUNLLElBQVQsRUFBZSxDQUNYLElBQUlMLElBQUksQ0FBQ2lCLEdBQUwsQ0FBVSxNQUFWLEVBQWtCNkUsZ0JBQWxCLEVBQUosRUFBMkMsQ0FDdkM5RixJQUFJLENBQUMySixtQkFBTCxDQUEwQjNKLElBQUksQ0FBQ2lCLEdBQUwsQ0FBVSxNQUFWLEVBQWtCWixJQUFsQixDQUF1QkMsSUFBakQsRUFDSCxDQUZELE1BRU8sQ0FDSE4sSUFBSSxDQUFDWSxXQUFMLENBQWtCWixJQUFJLENBQUNpQixHQUFMLENBQVUsTUFBVixFQUFrQlosSUFBcEMsRUFDSCxDQUNKLENBQ0osQ0FDRCxJQUFNRixZQUFZLEdBQUdhLFFBQVEsK3VDQUE3QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBmc3BhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCBfIGZyb20gJ3VuZGVyc2NvcmUnO1xuaW1wb3J0IHRlbXBsYXRlIGZyb20gXCJAYmFiZWwvdGVtcGxhdGVcIjtcbmltcG9ydCB7Z2V0fSBmcm9tICdsb2Rhc2gnO1xuXG5jb25zdCAkaGFuZGxlZCA9IFN5bWJvbCAoJ2hhbmRsZWQnKTtcbmNvbnN0ICRub3JtYWxpemVkID0gU3ltYm9sICgnbm9ybWFsaXplZCcpO1xuXG5jb25zdCBQUkVTRVJWRV9DT05URVhUUyA9IG5vcm1hbGl6ZUVudiAocHJvY2Vzcy5lbnYuVFJBQ0VfQ09OVEVYVCk7XG5jb25zdCBQUkVTRVJWRV9GSUxFUyA9IG5vcm1hbGl6ZUVudiAocHJvY2Vzcy5lbnYuVFJBQ0VfRklMRSk7XG5jb25zdCBQUkVTRVJWRV9MRVZFTFMgPSBub3JtYWxpemVFbnYgKHByb2Nlc3MuZW52LlRSQUNFX0xFVkVMKTtcblxuLyoqXG4gKiBOb3JtYWxpemUgYW4gZW52aXJvbm1lbnQgdmFyaWFibGUsIHVzZWQgdG8gb3ZlcnJpZGUgcGx1Z2luIG9wdGlvbnMuXG4gKi9cbmZ1bmN0aW9uIG5vcm1hbGl6ZUVudiAoaW5wdXQpe1xuICAgIGlmICghaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICByZXR1cm4gaW5wdXQuc3BsaXQgKCcsJylcbiAgICAubWFwIChjb250ZXh0ID0+IGNvbnRleHQudG9Mb3dlckNhc2UgKCkudHJpbSAoKSlcbiAgICAuZmlsdGVyIChpZCA9PiBpZCk7XG59XG5cbi8qKlxuICogTGlrZSBgdGVtcGxhdGUoKWAgYnV0IHJldHVybnMgYW4gZXhwcmVzc2lvbiwgbm90IGFuIGV4cHJlc3Npb24gc3RhdGVtZW50LlxuICovXG5mdW5jdGlvbiBleHByZXNzaW9uIChpbnB1dCwgdGVtcGxhdGUpIHtcbiAgICBjb25zdCBmbiA9IHRlbXBsYXRlIChpbnB1dCk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChpZHMpIHtcbiAgICAgICAgY29uc3Qgbm9kZSA9IGZuIChpZHMpO1xuICAgICAgICByZXR1cm4gbm9kZS5leHByZXNzaW9uID8gbm9kZS5leHByZXNzaW9uIDogbm9kZTtcbiAgICB9O1xufVxuXG4vKipcbiAqIFRoZSBkZWZhdWx0IGxvZygpIGZ1bmN0aW9uLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0TG9nRnVuY3Rpb24gKHt0eXBlczogdCwgdGVtcGxhdGV9LCBsb2dMZXZlbCkge1xuICAgIHJldHVybiBmdW5jdGlvbiBsb2cgKG1lc3NhZ2UsIG1ldGFkYXRhKSB7XG4gICAgICAgIGxldCBtZXNzYWdlRXhwcmVzc2lvbiA9IG1lc3NhZ2UubWVzc2FnZUV4cHJlc3Npb247XG4gICAgICAgIGxldCBwcmVmaXggPSBgJHttZXRhZGF0YS5jb250ZXh0fTpgO1xuICAgICAgICBpZiAobWV0YWRhdGEuaW5kZW50KSB7XG4gICAgICAgICAgICBwcmVmaXggKz0gKG5ldyBBcnJheSAobWV0YWRhdGEuaW5kZW50ICsgMSkpLmpvaW4gKCcgICcpO1xuICAgICAgICB9XG5cblxuICAgICAgICBpZiAodC5pc1NlcXVlbmNlRXhwcmVzc2lvbiAobWVzc2FnZS5jb250ZW50KSkge1xuICAgICAgICAgICAgcmV0dXJuIHQuY2FsbEV4cHJlc3Npb24gKFxuICAgICAgICAgICAgICAgIHQubWVtYmVyRXhwcmVzc2lvbiAoXG4gICAgICAgICAgICAgICAgICAgIHQuaWRlbnRpZmllciAoJ2NvbnNvbGUnKSxcbiAgICAgICAgICAgICAgICAgICAgdC5pZGVudGlmaWVyIChsb2dMZXZlbClcbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIFt0LnN0cmluZ0xpdGVyYWwgKHByZWZpeCldLmNvbmNhdCAobWVzc2FnZS5jb250ZW50LmV4cHJlc3Npb25zKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IExJTkUgPSBtZXRhZGF0YS5wYXRoLm5vZGUubG9jLnN0YXJ0LmxpbmU7XG4gICAgICAgICAgICByZXR1cm4gZXhwcmVzc2lvbiAoYFZNX1JVTk5FUl9UUkFDRS5hcHBseSh7bGluZTpMSU5FfSxbTE9HTEVWRUwsIFBSRUZJWCwgTUVTU0FHRSwgIERBVEFdKWAsIHRlbXBsYXRlKSAoe1xuICAgICAgICAgICAgICAgIExPR0xFVkVMOiB0LnN0cmluZ0xpdGVyYWwgKGxvZ0xldmVsKSxcbiAgICAgICAgICAgICAgICBQUkVGSVg6IHQuc3RyaW5nTGl0ZXJhbCAocHJlZml4KSxcbiAgICAgICAgICAgICAgICBEQVRBOiBtZXNzYWdlLmNvbnRlbnQsXG4gICAgICAgICAgICAgICAgTElORTp0Lm51bWVyaWNMaXRlcmFsKExJTkUpLFxuICAgICAgICAgICAgICAgIFZNX1JVTk5FUl9UUkFDRTp0LmlkZW50aWZpZXIgKCdWTV9SVU5ORVJfVFJBQ0UnKSxcbiAgICAgICAgICAgICAgICBNRVNTQUdFOm1lc3NhZ2VFeHByZXNzaW9uXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVQcmVmaXggKGRpcm5hbWUsIGJhc2VuYW1lKSB7XG4gICAgaWYgKGJhc2VuYW1lICE9PSAnaW5kZXgnKSB7XG4gICAgICAgIHJldHVybiBiYXNlbmFtZTtcbiAgICB9XG4gICAgYmFzZW5hbWUgPSBmc3BhdGguYmFzZW5hbWUgKGRpcm5hbWUpO1xuICAgIGlmIChiYXNlbmFtZSAhPT0gJ3NyYycgJiYgYmFzZW5hbWUgIT09ICdsaWInKSB7XG4gICAgICAgIHJldHVybiBiYXNlbmFtZTtcbiAgICB9XG4gICAgcmV0dXJuIGZzcGF0aC5iYXNlbmFtZSAoZnNwYXRoLmRpcm5hbWUgKGRpcm5hbWUpKTtcbn1cblxuLyoqXG4gKiBDb2xsZWN0IHRoZSBtZXRhZGF0YSBmb3IgYSBnaXZlbiBub2RlIHBhdGgsIHdoaWNoIHdpbGwgYmVcbiAqIG1hZGUgYXZhaWxhYmxlIHRvIGxvZ2dpbmcgZnVuY3Rpb25zLlxuICovXG5mdW5jdGlvbiBjb2xsZWN0TWV0YWRhdGEgKHBhdGgsIG9wdHMpIHtcbiAgICBjb25zdCBmaWxlbmFtZSA9IGZzcGF0aC5yZXNvbHZlIChwcm9jZXNzLmN3ZCAoKSwgcGF0aC5odWIuZmlsZS5vcHRzLmZpbGVuYW1lKTtcbiAgICBjb25zdCBkaXJuYW1lID0gZnNwYXRoLmRpcm5hbWUgKGZpbGVuYW1lKTtcbiAgICBjb25zdCBleHRuYW1lID0gZnNwYXRoLmV4dG5hbWUgKGZpbGVuYW1lKTtcbiAgICBjb25zdCBiYXNlbmFtZSA9IGZzcGF0aC5iYXNlbmFtZSAoZmlsZW5hbWUsIGV4dG5hbWUpO1xuICAgIGNvbnN0IHByZWZpeCA9IGdlbmVyYXRlUHJlZml4IChkaXJuYW1lLCBiYXNlbmFtZSk7XG4gICAgY29uc3QgbmFtZXMgPSBbXTtcbiAgICBsZXQgaW5kZW50ID0gMDtcbiAgICBsZXQgcGFyZW50O1xuXG4gICAgY29uc3QgcGFyZW50TmFtZSA9IHBhdGguZ2V0QW5jZXN0cnkgKCkuc2xpY2UgKDEpLnJlZHVjZSAoKHBhcnRzLCBpdGVtKSA9PiB7XG4gICAgICAgIGlmIChpdGVtLmlzQ2xhc3NNZXRob2QgKCkpIHtcbiAgICAgICAgICAgIGlmICghcGFyZW50KSB7XG4gICAgICAgICAgICAgICAgcGFyZW50ID0gaXRlbTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHBhcnRzLnVuc2hpZnQgKGl0ZW0ubm9kZS5rZXkudHlwZSA9PT0gJ0lkZW50aWZpZXInID8gaXRlbS5ub2RlLmtleS5uYW1lIDogJ1tjb21wdXRlZCBtZXRob2RdJyk7XG4gICAgICAgIH0gZWxzZSBpZiAoaXRlbS5pc0NsYXNzRGVjbGFyYXRpb24gKCkpIHtcbiAgICAgICAgICAgIGlmICghcGFyZW50KSB7XG4gICAgICAgICAgICAgICAgcGFyZW50ID0gaXRlbTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHBhcnRzLnVuc2hpZnQgKGl0ZW0ubm9kZS5pZCA/IGl0ZW0ubm9kZS5pZC5uYW1lIDogYFthbm9ueW1vdXMgY2xhc3NAJHtpdGVtLm5vZGUubG9jLnN0YXJ0LmxpbmV9XWApO1xuICAgICAgICB9IGVsc2UgaWYgKGl0ZW0uaXNGdW5jdGlvbiAoKSkge1xuICAgICAgICAgICAgaWYgKCFwYXJlbnQpIHtcbiAgICAgICAgICAgICAgICBwYXJlbnQgPSBpdGVtO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGFydHMudW5zaGlmdCAoKGl0ZW0ubm9kZS5pZCAmJiBpdGVtLm5vZGUuaWQubmFtZSkgfHwgYFthbm9ueW1vdXNAJHtpdGVtLm5vZGUubG9jLnN0YXJ0LmxpbmV9XWApO1xuICAgICAgICB9IGVsc2UgaWYgKGl0ZW0uaXNQcm9ncmFtICgpKSB7XG4gICAgICAgICAgICBpZiAoIXBhcmVudCkge1xuICAgICAgICAgICAgICAgIHBhcmVudCA9IGl0ZW07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoIXBhcmVudCAmJiAhaXRlbS5pc0NsYXNzQm9keSAoKSAmJiAhaXRlbS5pc0Jsb2NrU3RhdGVtZW50ICgpKSB7XG4gICAgICAgICAgICBpbmRlbnQrKztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFydHM7XG4gICAgfSwgW10pLmpvaW4gKCc6Jyk7XG5cbiAgICBsZXQgaGFzU3RhcnRNZXNzYWdlID0gZmFsc2U7XG4gICAgbGV0IGlzU3RhcnRNZXNzYWdlID0gZmFsc2U7XG4gICAgaWYgKHBhcmVudCAmJiAhcGFyZW50LmlzUHJvZ3JhbSAoKSkge1xuICAgICAgICBmb3IgKGxldCBjaGlsZCBvZiBwYXJlbnQuZ2V0ICgnYm9keScpLmdldCAoJ2JvZHknKSkge1xuICAgICAgICAgICAgaWYgKGNoaWxkLm5vZGVbJGhhbmRsZWRdKSB7XG4gICAgICAgICAgICAgICAgaGFzU3RhcnRNZXNzYWdlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghY2hpbGQuaXNMYWJlbGVkU3RhdGVtZW50ICgpKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBsYWJlbCA9IGNoaWxkLmdldCAoJ2xhYmVsJyk7XG4gICAgICAgICAgICBpZiAob3B0cy5hbGlhc2VzW2xhYmVsLm5vZGUubmFtZV0pIHtcbiAgICAgICAgICAgICAgICBoYXNTdGFydE1lc3NhZ2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmIChjaGlsZC5ub2RlID09PSBwYXRoLm5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaXNTdGFydE1lc3NhZ2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IGNvbnRleHQgPSBgJHtwcmVmaXh9OiR7cGFyZW50TmFtZX1gO1xuICAgIHJldHVybiB7aW5kZW50LCBwcmVmaXgsIHBhcmVudE5hbWUsIGNvbnRleHQsIGhhc1N0YXJ0TWVzc2FnZSwgaXNTdGFydE1lc3NhZ2UsIGZpbGVuYW1lLCBkaXJuYW1lLCBiYXNlbmFtZSwgZXh0bmFtZSwgcGF0aH07XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIHdoZXRoZXIgdGhlIGdpdmVuIGxvZ2dpbmcgc3RhdGVtZW50IHNob3VsZCBiZSBzdHJpcHBlZC5cbiAqL1xuZnVuY3Rpb24gc2hvdWxkU3RyaXAgKG5hbWUsIG1ldGFkYXRhLCB7c3RyaXB9KSB7XG4gICAgc3dpdGNoICh0eXBlb2Ygc3RyaXApIHtcbiAgICAgICAgY2FzZSAnYm9vbGVhbic6XG4gICAgICAgICAgICBpZiAoIXN0cmlwKSByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAvLyBzdHJpcCA9PT0gdHJ1ZVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ29iamVjdCc6XG4gICAgICAgICAgICBjb25zdCBzZSA9IHN0cmlwW25hbWVdO1xuICAgICAgICAgICAgaWYgKCFzZSB8fCAodHlwZW9mIHNlID09PSAnb2JqZWN0JyAmJiAhc2VbcHJvY2Vzcy5lbnYuTk9ERV9FTlZdKSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgLy8gc3RyaXBbbmFtZV0gPT09IHRydWUgfHwgc3RyaXBbbmFtZV1bZW52XSA9PT0gdHJ1ZVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChQUkVTRVJWRV9DT05URVhUUy5sZW5ndGgpIHtcbiAgICAgICAgY29uc3QgY29udGV4dCA9IG1ldGFkYXRhLmNvbnRleHQudG9Mb3dlckNhc2UgKCk7XG4gICAgICAgIGlmIChQUkVTRVJWRV9DT05URVhUUy5zb21lIChwYyA9PiBjb250ZXh0LmluY2x1ZGVzIChwYykpKSByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChQUkVTRVJWRV9GSUxFUy5sZW5ndGgpIHtcbiAgICAgICAgY29uc3QgZmlsZW5hbWUgPSBtZXRhZGF0YS5maWxlbmFtZS50b0xvd2VyQ2FzZSAoKTtcbiAgICAgICAgaWYgKFBSRVNFUlZFX0ZJTEVTLnNvbWUgKHBmID0+IGZpbGVuYW1lLmluY2x1ZGVzIChwZikpKSByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChQUkVTRVJWRV9MRVZFTFMubGVuZ3RoKSB7XG4gICAgICAgIGNvbnN0IGxldmVsID0gbmFtZS50b0xvd2VyQ2FzZSAoKTtcbiAgICAgICAgaWYgKFBSRVNFUlZFX0xFVkVMUy5zb21lIChwbCA9PiBsZXZlbCA9PT0gcGwpKSByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaGFuZGxlTGFiZWxlZFN0YXRlbWVudCAoYmFiZWwsIHBhdGgsIG9wdHMpIHtcbiAgICBjb25zdCB0ID0gYmFiZWwudHlwZXM7XG4gICAgY29uc3QgbGFiZWwgPSBwYXRoLmdldCAoJ2xhYmVsJyk7XG4gICAgb3B0cyA9IChmdW5jdGlvbiBub3JtYWxpemVPcHRzIChiYWJlbCwgb3B0cykge1xuICAgICAgICBpZiAob3B0c1skbm9ybWFsaXplZF0pIHtcbiAgICAgICAgICAgIHJldHVybiBvcHRzO1xuICAgICAgICB9XG4gICAgICAgIGlmICghb3B0cy5hbGlhc2VzKSB7XG4gICAgICAgICAgICBvcHRzLmFsaWFzZXMgPSB7XG4gICAgICAgICAgICAgICAgbG9nOiBnZXRMb2dGdW5jdGlvbiAoYmFiZWwsICdsb2cnKSxcbiAgICAgICAgICAgICAgICB0cmFjZTogZ2V0TG9nRnVuY3Rpb24gKGJhYmVsLCAndHJhY2UnKSxcbiAgICAgICAgICAgICAgICB3YXJuOiBnZXRMb2dGdW5jdGlvbiAoYmFiZWwsICd3YXJuJyksXG4gICAgICAgICAgICAgICAgZXJyb3I6Z2V0TG9nRnVuY3Rpb24oYmFiZWwsJ2Vycm9yJyksXG4gICAgICAgICAgICAgICAgZGVidWc6Z2V0TG9nRnVuY3Rpb24oYmFiZWwsJ2RlYnVnJylcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyAob3B0cy5hbGlhc2VzKS5mb3JFYWNoIChrZXkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygb3B0cy5hbGlhc2VzW2tleV0gPT09ICdzdHJpbmcnICYmIG9wdHMuYWxpYXNlc1trZXldKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4cHIgPSBleHByZXNzaW9uIChvcHRzLmFsaWFzZXNba2V5XSwgYmFiZWwudGVtcGxhdGUpO1xuICAgICAgICAgICAgICAgICAgICBvcHRzLmFsaWFzZXNba2V5XSA9IChtZXNzYWdlKSA9PiBleHByIChtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob3B0cy5zdHJpcCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBvcHRzLnN0cmlwID0ge1xuICAgICAgICAgICAgICAgIGxvZzoge3Byb2R1Y3Rpb246IHRydWV9LFxuICAgICAgICAgICAgICAgIHRyYWNlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB3YXJuOiB7cHJvZHVjdGlvbjogdHJ1ZX1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgb3B0c1skbm9ybWFsaXplZF0gPSB0cnVlO1xuICAgICAgICByZXR1cm4gb3B0cztcbiAgICB9KShiYWJlbCwgb3B0cyk7XG5cbiAgICBjb25zdCBsYWJlbE5hbWUgPSBsYWJlbC5ub2RlLm5hbWU7XG4gICAgY29uc3QgdmFyaWFibGVzID0gIFtdO1xuXG4gICAgY29uc3QgbWV0aG9kUGF0aCA9IGdldChwYXRoLCdwYXJlbnRQYXRoLnBhcmVudFBhdGgnLG51bGwpO1xuICAgIGlmKG1ldGhvZFBhdGggJiZbJ0NsYXNzTWV0aG9kJywnT2JqZWN0TWV0aG9kJ10uaW5kZXhPZihtZXRob2RQYXRoLnR5cGUpPi0xJiYhbWV0aG9kUGF0aC5ub2RlLnN0YXRpYyl7XG4gICAgICAgIHZhcmlhYmxlcy5wdXNoKCd0aGlzJyk7XG4gICAgfVxuICAgIF8uZWFjaCggcGF0aC5zY29wZS5iaW5kaW5ncyAsICh2YWwsa2V5KT0+e1xuICAgICAgICBpZih2YXJpYWJsZXMuaW5kZXhPZihrZXkpPT0tMSlcbiAgICAgICAgICAgIHZhcmlhYmxlcy5wdXNoKGtleSk7XG4gICAgfSk7XG5cblxuICAgIGNvbnN0IGFsaWFzID0gb3B0cy5hbGlhc2VzW2xhYmVsTmFtZV1cbiAgICBpZiAoIWFsaWFzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgbWV0YWRhdGEgPSBjb2xsZWN0TWV0YWRhdGEgKHBhdGgsIG9wdHMpO1xuICAgIGlmIChzaG91bGRTdHJpcCAobGFiZWwubm9kZS5uYW1lLCBtZXRhZGF0YSwgb3B0cykpIHtcbiAgICAgICAgcGF0aC5yZW1vdmUgKCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBwYXRoLnRyYXZlcnNlICh7XG4gICAgICAgIFwiRW1wdHlTdGF0ZW1lbnRcIiAoZW1wdHlTdGF0ZW1lbnQpe1xuICAgICAgICAgICAgbGV0IHByb3BlcnRpZXMgPSBfLm1hcCAodmFyaWFibGVzLCAodmFyTmFtZSkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBrZXkgPSB0LklkZW50aWZpZXIgKHZhck5hbWUpO1xuICAgICAgICAgICAgICAgIGxldCB2YWx1ZTtcbiAgICAgICAgICAgICAgICBpZih2YXJOYW1lIT0ndGhpcycpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB0LklkZW50aWZpZXIgKHZhck5hbWUpO1xuICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHQudGhpc0V4cHJlc3Npb24oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHQub2JqZWN0UHJvcGVydHkgKGtleSwgdmFsdWUsIGZhbHNlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbGV0IHJlcGxhY2VtZW50ID0gdC5vYmplY3RFeHByZXNzaW9uIChwcm9wZXJ0aWVzKTtcbiAgICAgICAgICAgIHJlcGxhY2VtZW50WyRoYW5kbGVkXSA9IHRydWU7XG4gICAgICAgICAgICBlbXB0eVN0YXRlbWVudC5yZXBsYWNlV2l0aCAocmVwbGFjZW1lbnQpO1xuICAgICAgICB9LFxuICAgICAgICAvKlwiVGVtcGxhdGVMaXRlcmFsfFN0cmluZ0xpdGVyYWxcIihpdGVtKXtcblxuICAgICAgICB9LCovXG4gICAgICAgIFwiVmFyaWFibGVEZWNsYXJhdGlvbnxGdW5jdGlvbnxBc3NpZ25tZW50RXhwcmVzc2lvbnxVcGRhdGVFeHByZXNzaW9ufFlpZWxkRXhwcmVzc2lvbnxSZXR1cm5TdGF0ZW1lbnRcIiAoaXRlbSkge1xuICAgICAgICAgICAgdGhyb3cgcGF0aC5idWlsZENvZGVGcmFtZUVycm9yIChgTG9nZ2luZyBzdGF0ZW1lbnRzIGNhbm5vdCBoYXZlIHNpZGUgZWZmZWN0cy4gJHtpdGVtLnR5cGV9YCk7XG4gICAgICAgIH0sXG4gICAgICAgIEV4cHJlc3Npb25TdGF0ZW1lbnQgKHN0YXRlbWVudCkge1xuICAgICAgICAgICAgaWYgKHN0YXRlbWVudC5ub2RlWyRoYW5kbGVkXSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCB0YXJnZXROb2RlID0gc3RhdGVtZW50LmdldCAoJ2V4cHJlc3Npb24nKS5ub2RlO1xuICAgICAgICAgICAgY29uc3QgbWVzc2FnZUVsZW1lbnRzID0gW107XG4gICAgICAgICAgICBpZih0YXJnZXROb2RlLnR5cGU9PT0nU2VxdWVuY2VFeHByZXNzaW9uJyl7XG4gICAgICAgICAgICAgICAgbGV0IHByb3BlcnRpZXMgPSBfLmNoYWluKHRhcmdldE5vZGUuZXhwcmVzc2lvbnMpLm1hcCgoZXhwcmVzc2lvbk5vZGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYoWydJZGVudGlmaWVyJywnVGhpc0V4cHJlc3Npb24nXS5pbmRleE9mKGV4cHJlc3Npb25Ob2RlLnR5cGUpPi0xKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB2YXJOYW1lID0gZXhwcmVzc2lvbk5vZGUudHlwZT09PSdJZGVudGlmaWVyJz9leHByZXNzaW9uTm9kZS5uYW1lOid0aGlzJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBrZXkgPSB0LklkZW50aWZpZXIgKHZhck5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoZXhwcmVzc2lvbk5vZGUudHlwZT09PSdJZGVudGlmaWVyJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdC5JZGVudGlmaWVyICh2YXJOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdC50aGlzRXhwcmVzc2lvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQub2JqZWN0UHJvcGVydHkgKGtleSwgdmFsdWUsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgfWVsc2UgaWYoWydTdHJpbmdMaXRlcmFsJywnVGVtcGxhdGVMaXRlcmFsJ10uaW5kZXhPZihleHByZXNzaW9uTm9kZS50eXBlKT4tMSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlRWxlbWVudHMucHVzaChleHByZXNzaW9uTm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5jb21wYWN0KCkudmFsdWUoKTtcbiAgICAgICAgICAgICAgICBpZiggXy5pc0VtcHR5KHByb3BlcnRpZXMpICYmICFfLmlzRW1wdHkobWVzc2FnZUVsZW1lbnRzKSApe1xuICAgICAgICAgICAgICAgICAgICBsZXQgcHJvcGVydGllcyA9IF8ubWFwICh2YXJpYWJsZXMsICh2YXJOYW1lKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQga2V5ID0gdC5JZGVudGlmaWVyICh2YXJOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHZhck5hbWUhPSd0aGlzJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdC5JZGVudGlmaWVyICh2YXJOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdC50aGlzRXhwcmVzc2lvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQub2JqZWN0UHJvcGVydHkgKGtleSwgdmFsdWUsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldE5vZGUgPSB0Lm9iamVjdEV4cHJlc3Npb24gKHByb3BlcnRpZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldE5vZGUgPSB0Lm9iamVjdEV4cHJlc3Npb24gKHByb3BlcnRpZXMpO1xuICAgICAgICAgICAgfWVsc2UgaWYoWydUZW1wbGF0ZUxpdGVyYWwnLCdTdHJpbmdMaXRlcmFsJ10uaW5kZXhPZih0YXJnZXROb2RlLnR5cGUpPi0xKXtcbiAgICAgICAgICAgICAgICBtZXNzYWdlRWxlbWVudHMucHVzaCh0YXJnZXROb2RlKTtcblxuICAgICAgICAgICAgICAgIGxldCBwcm9wZXJ0aWVzID0gXy5tYXAgKHZhcmlhYmxlcywgKHZhck5hbWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGtleSA9IHQuSWRlbnRpZmllciAodmFyTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYodmFyTmFtZSE9J3RoaXMnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHQuSWRlbnRpZmllciAodmFyTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB0LnRoaXNFeHByZXNzaW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQub2JqZWN0UHJvcGVydHkgKGtleSwgdmFsdWUsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0YXJnZXROb2RlID0gdC5vYmplY3RFeHByZXNzaW9uIChwcm9wZXJ0aWVzKTtcbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlRXhwcmVzc2lvbiA9IHQuY2FsbEV4cHJlc3Npb24oXG4gICAgICAgICAgICAgICAgdC5tZW1iZXJFeHByZXNzaW9uKFxuICAgICAgICAgICAgICAgICAgICB0LmFycmF5RXhwcmVzc2lvbihtZXNzYWdlRWxlbWVudHMpLC8vb2JqZWN0XG4gICAgICAgICAgICAgICAgICAgIHQuaWRlbnRpZmllcignam9pbicpLC8vcHJvcGVydHlcbiAgICAgICAgICAgICAgICAgICAgZmFsc2UvL2NvbXB1dGVkXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICwgW1xuICAgICAgICAgICAgICAgICAgICB0LnN0cmluZ0xpdGVyYWwoJyAnKVxuICAgICAgICAgICAgICAgIF0pO1xuXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlID0ge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2VFeHByZXNzaW9uLFxuICAgICAgICAgICAgICAgIHByZWZpeDogdC5zdHJpbmdMaXRlcmFsIChtZXRhZGF0YS5wcmVmaXgpLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHRhcmdldE5vZGUsXG4gICAgICAgICAgICAgICAgaGFzU3RhcnRNZXNzYWdlOiB0LmJvb2xlYW5MaXRlcmFsIChtZXRhZGF0YS5oYXNTdGFydE1lc3NhZ2UpLFxuICAgICAgICAgICAgICAgIGlzU3RhcnRNZXNzYWdlOiB0LmJvb2xlYW5MaXRlcmFsIChtZXRhZGF0YS5pc1N0YXJ0TWVzc2FnZSksXG4gICAgICAgICAgICAgICAgaW5kZW50OiB0Lm51bWVyaWNMaXRlcmFsIChtZXRhZGF0YS5pbmRlbnQpLFxuICAgICAgICAgICAgICAgIHBhcmVudE5hbWU6IHQuc3RyaW5nTGl0ZXJhbCAobWV0YWRhdGEucGFyZW50TmFtZSksXG4gICAgICAgICAgICAgICAgZmlsZW5hbWU6IHQuc3RyaW5nTGl0ZXJhbCAobWV0YWRhdGEuZmlsZW5hbWUpLFxuICAgICAgICAgICAgICAgIGRpcm5hbWU6IHQuc3RyaW5nTGl0ZXJhbCAobWV0YWRhdGEuZGlybmFtZSksXG4gICAgICAgICAgICAgICAgYmFzZW5hbWU6IHQuc3RyaW5nTGl0ZXJhbCAobWV0YWRhdGEuYmFzZW5hbWUpLFxuICAgICAgICAgICAgICAgIGV4dG5hbWU6IHQuc3RyaW5nTGl0ZXJhbCAobWV0YWRhdGEuZXh0bmFtZSlcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjb25zdCByZXBsYWNlbWVudCA9IHQuZXhwcmVzc2lvblN0YXRlbWVudCAoYWxpYXMgKG1lc3NhZ2UsIG1ldGFkYXRhKSk7XG4gICAgICAgICAgICByZXBsYWNlbWVudFskaGFuZGxlZF0gPSB0cnVlO1xuICAgICAgICAgICAgc3RhdGVtZW50LnJlcGxhY2VXaXRoIChyZXBsYWNlbWVudCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmIChwYXRoLm5vZGUpIHtcbiAgICAgICAgaWYgKHBhdGguZ2V0ICgnYm9keScpLmlzQmxvY2tTdGF0ZW1lbnQgKCkpIHtcbiAgICAgICAgICAgIHBhdGgucmVwbGFjZVdpdGhNdWx0aXBsZSAocGF0aC5nZXQgKCdib2R5Jykubm9kZS5ib2R5KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHBhdGgucmVwbGFjZVdpdGggKHBhdGguZ2V0ICgnYm9keScpLm5vZGUpO1xuICAgICAgICB9XG4gICAgfVxufVxuY29uc3Qgd3JhcFZtUnVubmVyID0gdGVtcGxhdGUgKGBcbnZhciBWTV9SVU5ORVJfUlVOX0lEID0gJyc7XG5cbmZ1bmN0aW9uIGdlbmVyYXRlVWlkKCl7XG4gICAgdmFyIHU9JycsaT0wOyB2YXIgZm91ciA9IDQ7XG4gICAgdmFyIHBhdHRlcm4gPSAneHh4eHh4eHgteHh4eC0nK2ZvdXIrJ3h4eC15eHh4LXh4eHh4eHh4eHh4eCc7XG4gICAgd2hpbGUoaSsrPDM2KSB7XG4gICAgICAgIHZhciBjPXBhdHRlcm5baS0xXSxcbiAgICAgICAgcj1NYXRoLnJhbmRvbSgpKjE2fDAsdj1jPT0neCc/cjoociYweDN8MHg4KTtcbiAgICAgICAgdSs9KGM9PSctJ3x8Yz09Zm91cik/Yzp2LnRvU3RyaW5nKDE2KVxuICAgIH1cbiAgICByZXR1cm4gdTtcbn0gXG5cbmlmKCB0eXBlb2Yodm0yT3B0aW9ucyk9PT0ndW5kZWZpbmVkJyApe1xuICB2bTJPcHRpb25zID0ge307XG59XG52YXIgVk1fUlVOTkVSX0hBU0ggPSB2bTJPcHRpb25zLlZNX1JVTk5FUl9IQVNIO1xudmFyIGN1c3RvbU9wdGlvbnMgPSB2bTJPcHRpb25zLmN1c3RvbU9wdGlvbnMgfHwge307XG52YXIgdHJhY2VPcHRpb25zID0gY3VzdG9tT3B0aW9ucy50cmFjZXx8e307XG52YXIgdm0yRXhwcmVzc2lvbiA9IHZtMk9wdGlvbnMuZXhwcmVzc2lvbiB8fCBudWxsO1xuXG52YXIgVk1fUlVOTkVSX1RSQUNFID0gZnVuY3Rpb24obG9nTGV2ZWwscHJlZml4LG1lc3NhZ2UsZGF0YSl7XG4gICAgdmFyIGFsaWFzID0gdHJhY2VPcHRpb25zICYmIHRyYWNlT3B0aW9ucy5hbGlhc2VzICYmIHRyYWNlT3B0aW9ucy5hbGlhc2VzW2xvZ0xldmVsXSA7XG4gICAgdmFyIG1lc3NhZ2VPYmogPSB7XG4gICAgICAgIGZyYW1lOnZtQ29kZUZyYW1lKHZtMkV4cHJlc3Npb24sdGhpcy5saW5lKSxcbiAgICAgICAgcHJlZml4OnByZWZpeCxcbiAgICAgICAgbWVzc2FnZTptZXNzYWdlLFxuICAgICAgICBsb2dMZXZlbDpsb2dMZXZlbCxcbiAgICAgICAgZGF0YTpkYXRhLFxuICAgICAgICBsaW5lOnRoaXMubGluZSxcbiAgICAgICAgZGF0ZTpuZXcgRGF0ZSgpXG4gICAgfVxuICAgIGlmKCBhbGlhcyApe1xuICAgICAgICB0cnl7XG4gICAgICAgICAgICByZXR1cm4gYWxpYXMuYXBwbHkodGhpcyxbbWVzc2FnZU9ial0pO1xuICAgICAgICB9Y2F0Y2goZSl7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgICB9XG4gICAgfVxufTtcblxuXG5cbnJldHVybiAoZnVuY3Rpb24gdm1SdW5uZXJXcmFwcGVyKCkge1xuICAgIFZNX1JVTk5FUl9SVU5fSUQgPSBnZW5lcmF0ZVVpZCgpO1xuICAgIFxuICAgIEJPRFk7XG59KS5hcHBseSh0aGlzKTtcbmApO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiAoYmFiZWwpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICB2aXNpdG9yOiB7XG4gICAgICAgICAgICBQcm9ncmFtIChwcm9ncmFtLCB7b3B0c30pIHtcbiAgICAgICAgICAgICAgICBwcm9ncmFtLnRyYXZlcnNlICh7XG4gICAgICAgICAgICAgICAgICAgIExhYmVsZWRTdGF0ZW1lbnQgKHBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUxhYmVsZWRTdGF0ZW1lbnQgKGJhYmVsLCBwYXRoLCBvcHRzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFwcm9ncmFtLnZtUnVubmVyV3JhcHBlcikge1xuICAgICAgICAgICAgICAgICAgICBwcm9ncmFtLnZtUnVubmVyV3JhcHBlciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHZhciB3cmFwcGVkID0gd3JhcFZtUnVubmVyICh7XG4gICAgICAgICAgICAgICAgICAgICAgICBCT0RZOiBwcm9ncmFtLm5vZGUuYm9keSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFZNX1JVTk5FUl9SVU5fSUQ6YmFiZWwudHlwZXMuaWRlbnRpZmllciAoJ1ZNX1JVTk5FUl9SVU5fSUQnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFZNX1JVTk5FUl9IQVNIOmJhYmVsLnR5cGVzLmlkZW50aWZpZXIgKCdWTV9SVU5ORVJfSEFTSCcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgVk1fUlVOTkVSX1RSQUNFOmJhYmVsLnR5cGVzLmlkZW50aWZpZXIgKCdWTV9SVU5ORVJfVFJBQ0UnKSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgcHJvZ3JhbS5yZXBsYWNlV2l0aCAoXG4gICAgICAgICAgICAgICAgICAgICAgICBiYWJlbC50eXBlcy5wcm9ncmFtICh3cmFwcGVkKVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwcm9ncmFtLm5vZGUuZGlyZWN0aXZlcyA9IFtdO1xuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufVxuIl19